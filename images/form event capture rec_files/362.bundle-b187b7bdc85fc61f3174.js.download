/*! For license information please see 362.bundle-b187b7bdc85fc61f3174.js.LICENSE.txt */
"use strict";(self.webpackChunkawesomescreenshot_website=self.webpackChunkawesomescreenshot_website||[]).push([[362],{59413:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var r=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){return(0,r.jsx)("svg",a(a({width:"1em",height:"1em",viewBox:"0 0 17 17",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,r.jsx)("path",{d:"M16.524.775c.01.049.01.1 0 .149l-1.598 7.99a.381.381 0 0 1-.733.05l-.968-2.812L1.26 16.278a.381.381 0 0 1-.428.044l-.065-.044a.381.381 0 0 1-.044-.537l10.144-11.99-2.81-.946a.381.381 0 0 1 .048-.735L16.076.476a.381.381 0 0 1 .448.299Z",fill:"currentColor",fillRule:"evenodd"})}))}},15191:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var r=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){return(0,r.jsx)("svg",a(a({width:"1em",height:"1em",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,r.jsx)("ellipse",{cx:8,cy:8,rx:7.067,stroke:"currentColor",ry:6.067,strokeWidth:1.867,fill:"none",fillRule:"evenodd"})}))}},92011:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var r=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){return(0,r.jsx)("svg",a(a({width:"1em",height:"1em",stroke:"currentColor",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,r.jsx)("path",{d:"M.941 2.941h14.118v10.118H.941z",strokeWidth:1.882,fill:"none",fillRule:"evenodd"})}))}},85530:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var r=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){return(0,r.jsx)("svg",a(a({width:"1em",height:"1em",viewBox:"0 0 12 12",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,r.jsx)("path",{d:"M6.018.5C8.672 3.713 10 6.053 10 7.52c0 2.547-1.865 3.98-3.982 3.98S2 10.067 2 7.52c0-1.158.834-2.86 2.504-5.107l.345-.456c.119-.155.241-.312.367-.471L5.606 1c.133-.164.27-.33.412-.5Zm-.004 1.609-.169.215c-.119.152-.234.301-.345.448l-.323.433-.153.211-.29.41C3.577 5.497 3 6.75 3 7.518c0 1.796 1.261 2.95 3.018 2.95C7.764 10.469 9 9.324 9 7.519c0-.646-.403-1.634-1.212-2.925l-.243-.377c-.211-.322-.446-.66-.703-1.014l-.32-.433a37.274 37.274 0 0 0-.169-.223l-.339-.438Z",fill:"#FFF",fillRule:"nonzero",stroke:"#FFF",strokeWidth:.5})}))}},34102:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var r=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){return(0,r.jsx)("svg",a(a({width:"1em",height:"1em",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,r.jsx)("path",{d:"M3.344.5C1.495.5 0 1.946 0 3.726c0 1.718 1.394 3.125 3.148 3.22l.189.005.19-.005a3.41 3.41 0 0 0 1.56-.468l.197-.125.16-.11 2.072 1.68-2.17 1.761-.16-.101a3.414 3.414 0 0 0-1.842-.534C1.495 9.049 0 10.495 0 12.274c0 1.78 1.495 3.226 3.344 3.226 1.848 0 3.343-1.446 3.343-3.226 0-.385-.07-.761-.205-1.114l-.088-.21-.086-.182 2.357-1.913 5.06 4.104.136.101a1.778 1.778 0 0 0 2.097-.083L16 12.94 9.816 7.92l6.182-5.016-.034-.03a1.779 1.779 0 0 0-1.955-.18l-.14.086-.135.099-5.068 4.109-2.301-1.866.075-.179c.163-.383.247-.795.247-1.218C6.687 1.946 5.192.5 3.344.5Zm0 9.971c1.024 0 1.857.806 1.857 1.803 0 .998-.833 1.804-1.857 1.804-1.025 0-1.858-.806-1.858-1.804 0-.997.833-1.803 1.858-1.803Zm0-8.549c1.024 0 1.857.806 1.857 1.804 0 .997-.833 1.803-1.857 1.803-1.025 0-1.858-.806-1.858-1.803 0-.998.833-1.804 1.858-1.804Z",fillRule:"nonzero"})}))}},61579:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var r=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){return(0,r.jsx)("svg",a(a({width:"1em",height:"1em",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,r.jsx)("path",{d:"M4.08 5.903a.79.79 0 0 0-.693.15l-.078.073-1.98 1.98a4.537 4.537 0 0 0 6.246 6.576l.169-.16 1.982-1.98a.787.787 0 0 0-1.025-1.19l-.089.076-1.983 1.98a2.962 2.962 0 0 1-4.318-4.046l.131-.142 1.985-1.985a.788.788 0 0 0-.246-1.3l-.101-.032Zm6.623-.755a.789.789 0 0 0-1.026-.077l-.088.076-4.64 4.64a.787.787 0 0 0 1.025 1.19l.089-.076 4.64-4.64a.789.789 0 0 0 .076-1.025l-.076-.088Zm3.669-3.67a4.538 4.538 0 0 0-6.247-.16l-.169.16-1.959 1.96a.787.787 0 0 0 1.025 1.19l.089-.077 1.96-1.96a2.962 2.962 0 0 1 4.318 4.047l-.131.142-1.969 1.969a.787.787 0 0 0 1.026 1.19l.088-.076 1.969-1.97a4.537 4.537 0 0 0 0-6.415Z",fillRule:"nonzero"})}))}},41374:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var r=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){return(0,r.jsx)("svg",a(a({width:"1em",height:"1em",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,r.jsx)("path",{d:"M14.416.5c.323 0 .584.255.584.565v2.374l-1.482-1.434h-4.74l-.001 11.818h1.909c.45 0 .814.365.814.815v.048c0 .45-.365.814-.814.814l-1.314-.001-.01.001H5.314a.814.814 0 0 1-.814-.814v-.048c0-.45.365-.814.814-.814l1.908-.001V2.005h-4.74L1 3.44V1.065C1 .753 1.26.5 1.583.5Z",fillRule:"nonzero"})}))}},11860:(e,t,n)=>{n.d(t,{G9:()=>w,M9:()=>j});var r,o,a,i,s,c,l,u,d="transform",f=d+"Origin",h=function(e){var t=e.ownerDocument||e;!(d in e.style)&&"msTransform"in e.style&&(f=(d="msTransform")+"Origin");for(;t.parentNode&&(t=t.parentNode););if(o=window,l=new w,t){r=t,a=t.documentElement,i=t.body;var n=t.createElement("div"),s=t.createElement("div");i.appendChild(n),n.appendChild(s),n.style.position="static",n.style[d]="translate3d(0,0,1px)",u=s.offsetParent!==n,i.removeChild(n)}return t},p=[],m=[],g=function(e){return e.ownerSVGElement||("svg"===(e.tagName+"").toLowerCase()?e:null)},y=function e(t){return"fixed"===o.getComputedStyle(t).position||((t=t.parentNode)&&1===t.nodeType?e(t):void 0)},v=function e(t,n){if(t.parentNode&&(r||h(t))){var o=g(t),a=o?o.getAttribute("xmlns")||"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",i=o?n?"rect":"g":"div",l=2!==n?0:100,u=3===n?100:0,d="position:absolute;display:block;pointer-events:none;margin:0;padding:0;",f=r.createElementNS?r.createElementNS(a.replace(/^https/,"http"),i):r.createElement(i);return n&&(o?(c||(c=e(t)),f.setAttribute("width",.01),f.setAttribute("height",.01),f.setAttribute("transform","translate("+l+","+u+")"),c.appendChild(f)):(s||((s=e(t)).style.cssText=d),f.style.cssText=d+"width:0.1px;height:0.1px;top:"+u+"px;left:"+l+"px",s.appendChild(f))),f}throw"Need document and parent."},x=function(e,t){var n,r,a,i,h,y,x=g(e),b=e===x,j=x?p:m,S=e.parentNode;if(e===o)return e;if(j.length||j.push(v(e,1),v(e,2),v(e,3)),n=x?c:s,x)a=b?{x:0,y:0}:e.getBBox(),(r=e.transform?e.transform.baseVal:{}).numberOfItems?(i=(r=r.numberOfItems>1?function(e){for(var t=new w,n=0;n<e.numberOfItems;n++)t.multiply(e.getItem(n).matrix);return t}(r):r.getItem(0).matrix).a*a.x+r.c*a.y,h=r.b*a.x+r.d*a.y):(r=l,i=a.x,h=a.y),t&&"g"===e.tagName.toLowerCase()&&(i=h=0),(b?x:S).appendChild(n),n.setAttribute("transform","matrix("+r.a+","+r.b+","+r.c+","+r.d+","+(r.e+i)+","+(r.f+h)+")");else{if(i=h=0,u)for(r=e.offsetParent,a=e;a&&(a=a.parentNode)&&a!==r&&a.parentNode;)(o.getComputedStyle(a)[d]+"").length>4&&(i=a.offsetLeft,h=a.offsetTop,a=0);if("absolute"!==(y=o.getComputedStyle(e)).position)for(r=e.offsetParent;S&&S!==r;)i+=S.scrollLeft||0,h+=S.scrollTop||0,S=S.parentNode;(a=n.style).top=e.offsetTop-h+"px",a.left=e.offsetLeft-i+"px",a[d]=y[d],a[f]=y[f],a.position="fixed"===y.position?"fixed":"absolute",e.parentNode.appendChild(n)}return n},b=function(e,t,n,r,o,a,i){return e.a=t,e.b=n,e.c=r,e.d=o,e.e=a,e.f=i,e},w=function(){function e(e,t,n,r,o,a){void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o=0),void 0===a&&(a=0),b(this,e,t,n,r,o,a)}var t=e.prototype;return t.inverse=function(){var e=this.a,t=this.b,n=this.c,r=this.d,o=this.e,a=this.f,i=e*r-t*n||1e-10;return b(this,r/i,-t/i,-n/i,e/i,(n*a-r*o)/i,-(e*a-t*o)/i)},t.multiply=function(e){var t=this.a,n=this.b,r=this.c,o=this.d,a=this.e,i=this.f,s=e.a,c=e.c,l=e.b,u=e.d,d=e.e,f=e.f;return b(this,s*t+l*r,s*n+l*o,c*t+u*r,c*n+u*o,a+d*t+f*r,i+d*n+f*o)},t.clone=function(){return new e(this.a,this.b,this.c,this.d,this.e,this.f)},t.equals=function(e){var t=this.a,n=this.b,r=this.c,o=this.d,a=this.e,i=this.f;return t===e.a&&n===e.b&&r===e.c&&o===e.d&&a===e.e&&i===e.f},t.apply=function(e,t){void 0===t&&(t={});var n=e.x,r=e.y,o=this.a,a=this.b,i=this.c,s=this.d,c=this.e,l=this.f;return t.x=n*o+r*i+c||0,t.y=n*a+r*s+l||0,t},e}();function j(e,t,n,s){if(!e||!e.parentNode||(r||h(e)).documentElement===e)return new w;var c=function(e){for(var t,n;e&&e!==i;)(n=e._gsap)&&n.uncache&&n.get(e,"x"),n&&!n.scaleX&&!n.scaleY&&n.renderTransform&&(n.scaleX=n.scaleY=1e-4,n.renderTransform(1,n),t?t.push(n):t=[n]),e=e.parentNode;return t}(e),l=g(e)?p:m,u=x(e,n),d=l[0].getBoundingClientRect(),f=l[1].getBoundingClientRect(),v=l[2].getBoundingClientRect(),b=u.parentNode,j=!s&&y(e),S=new w((f.left-d.left)/100,(f.top-d.top)/100,(v.left-d.left)/100,(v.top-d.top)/100,d.left+(j?0:o.pageXOffset||r.scrollLeft||a.scrollLeft||i.scrollLeft||0),d.top+(j?0:o.pageYOffset||r.scrollTop||a.scrollTop||i.scrollTop||0));if(b.removeChild(u),c)for(d=c.length;d--;)(f=c[d]).scaleX=f.scaleY=0,f.renderTransform(1,f);return t?S.inverse():S}},66140:(e,t,n)=>{n.d(t,{Z:()=>H});var r=n(45697),o=n.n(r),a=n(67294),i=n(1852),s=n(16514),c=n(56010),l=n(35552),u=n(85893);function d(e){var t=e.className,n=e.title,r=e.onClick,o=e.icon,a=t?"asp-control-btn ".concat(t):"asp-control-btn";return n||(a+=" notitle"),(0,u.jsx)("div",{className:a,"aria-label":n,onClick:r,children:(0,u.jsx)("div",{className:"asp-control-btn-icon",children:o})})}const f=(0,a.memo)(d);function h(){return(0,u.jsx)("div",{className:"asp-loading-block",children:(0,u.jsx)("svg",{"data-v-8211":"",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",children:(0,u.jsxs)("g",{fill:"none",strokeWidth:"5",strokeMiterlimit:"10",stroke:"currentColor",children:[(0,u.jsx)("circle",{cx:"25",cy:"25",r:"20",opacity:".3"}),(0,u.jsx)("circle",{cx:"25",cy:"25",r:"20",strokeDasharray:"25,200",strokeLinecap:"round",className:"asp-loading-block-circle"})]})})})}const p=(0,a.memo)(h);var m=n(23279),g=n.n(m);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const x=function(e){var t=e.videoRef,n=e.duration,r=e.currentSec,o=e.isCollapsed,i=e.handlePlayPercentageChange,s=e.handleSeekingStart,l=e.handleSeekingEnd,d=y((0,a.useState)(!1),2),f=d[0],h=d[1],p=y((0,a.useState)(!1),2),m=p[0],v=p[1],x=y((0,a.useState)(0),2),b=x[0],w=x[1],j=y((0,a.useState)(0),2),S=j[0],P=j[1],O=y((0,a.useState)(0),2),k=O[0],C=O[1],A=y((0,a.useState)(0),2),E=A[0],I=A[1],D=y((0,a.useState)(0),2),F=D[0],N=D[1],T=y((0,a.useState)([]),2),Z=T[0],R=T[1],B=(0,a.useRef)(null),L=(0,a.useRef)(),V=((0,a.useRef)(),(0,a.useRef)()),U=(0,a.useRef)(!1),z=(0,a.useRef)(0),M=(0,a.useRef)(0),_=(0,a.useRef)(0);(0,a.useEffect)((function(){var e=t.current;return e.addEventListener("progress",H,!1),function(){e.removeEventListener("progress",H,!1)}}),[]),(0,a.useEffect)((function(){var e=r/n;I(e),N(e*B.current.offsetWidth)}),[r]);var H=function(e){for(var t=e.target.buffered,n=[],r=0;r<t.length;r++){var o=t.start(r)/e.target.duration,a=t.end(r)/e.target.duration-o,i=Math.ceil(100*o)+"%",s=Math.ceil(100*a)+"%";n.push({left:i,width:s})}R(n)},W=g()((function(){t.current.currentTime=_.current*n}),300),q=function(e){var t=e.pageX||e.changedTouches[0].pageX,n=B.current;if(U.current){var r=(M.current+(t-z.current))/n.offsetWidth;r>1&&(r=1),r<0&&(r=0),_.current=r,I(r),i(r),W()}},X=function e(){U.current=!1,h(!1),t.current.currentTime=_.current*n,l(),document.documentElement.removeEventListener("mousemove",q,!1),document.documentElement.removeEventListener("mouseup",e,!1),document.documentElement.removeEventListener("touchmove",q,!1),document.documentElement.removeEventListener("touchend",e,!1)},K=function(e){var t=B.current,n=((e.pageX||e.nativeEvent.changedTouches[0].pageX)-t.getBoundingClientRect().x)/t.offsetWidth;_.current=n,I(n),i(n),function(e,t){var n=e.pageX||e.changedTouches[0].pageX;U.current=!0,z.current=n,M.current=t*B.current.offsetWidth,h(!0),s()}(e,n),document.documentElement.addEventListener("mousemove",q,!1),document.documentElement.addEventListener("mouseup",X,!1),document.documentElement.addEventListener("touchmove",q,!1),document.documentElement.addEventListener("touchend",X,!1)};return(0,u.jsxs)("div",{className:"asp-progress-bar ".concat(f?"seeking":""),onMouseEnter:function(){o||v(!0)},onMouseLeave:function(){v(!1)},onMouseMove:function(e){var t=e.pageX||e.changedTouches[0].pageX;if(!V.current){var r=B.current,o=t-r.getBoundingClientRect().x,a=o-90,i=o/r.offsetWidth;a<0?a=0:a+180>r.offsetWidth&&(a=r.offsetWidth-180),o<20?o=20:o>r.offsetWidth-20&&(o=r.offsetWidth-20),C(i*n),w(o+"px"),P(i)}},children:[(0,u.jsx)("div",{className:"reaction-container"}),(0,u.jsxs)("div",{className:"asp-progress-track",ref:B,onMouseDown:K,onTouchStart:K,children:[(0,u.jsxs)("div",{className:"asp-progress-track-inner",children:[(0,u.jsx)("div",{className:"asp-progress-current",style:{transform:"scaleX(".concat(E,")")}}),(0,u.jsx)("div",{className:"asp-progress-locator-track  ".concat(m?"show":""),style:{transform:"scaleX(".concat(S,")")}})]}),(0,u.jsx)("div",{className:"asp-progress-indicator",style:{transform:"translateX(".concat(F,"px)")},ref:L,children:(0,u.jsx)("div",{className:"asp-progress-indicator-ball"})}),(0,u.jsx)("div",{className:"asp-buffer-blocks-container",children:Z.map((function(e,t){return(0,u.jsx)("div",{className:"asp-buffer-block",style:{left:e.left,width:e.width}},t)}))})]}),(0,u.jsx)("div",{className:"asp-progress-locator-time ".concat(m?"show":""),style:{transform:"translateX(".concat(b,")")},children:(0,c.z7)(k)})]})};var b=n(56262),w=n(18282);function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t=e.reaction,n=e.left,r=e.playerRef,o=(e.onReactionAnimationEnd,e.handleOnClick),i=e.isAnimate,s=t.comment,c=j((0,a.useState)("translateX(0)"),2),d=c[0],f=c[1],h=j((0,a.useState)(!1),2),p=h[0],m=h[1],g=(0,a.useRef)(null);(0,a.useEffect)((function(){m(i||s.animation)}),[i,s.animation]);return(0,u.jsxs)("div",{className:"asp-reaction-icon-wrapper ".concat(p?"animate":""," ").concat(t.type),style:{left:n},onMouseEnter:function(){var e=r.current.getBoundingClientRect().x+r.current.getBoundingClientRect().width,t=g.current.getBoundingClientRect().x+g.current.getBoundingClientRect().width;t>e&&f("translateX(-"+(t-e+3)+"px)")},onMouseLeave:function(){f("translateX(0)")},onAnimationEnd:function(e){m(!1)},onClick:function(){o(t)},children:["emoji"===t.type&&(0,u.jsx)("div",{className:"asp-reaction-icon",children:s.content}),"comment"===t.type&&(0,u.jsxs)("div",{className:"asp-reaction-icon asp-reaction-comment-icon",children:[(0,u.jsx)(l.Pg,{}),(0,u.jsx)("div",{className:"asp-reaction-comment-icon-count",children:t.count})]}),(0,u.jsx)("div",{className:"asp-reaction-panel",ref:g,style:{transform:d},children:(0,u.jsxs)("div",{className:"asp-reaction-comment-item ".concat(s.isEmoji?"emoji":""),children:[(0,u.jsxs)("div",{className:"avatar-area",title:s.userName,children:[(0,u.jsx)(w.Z,{username:s.userName,avatarUrl:s.userAvatar,size:"16"})," ",":"]}),(0,u.jsxs)("div",{className:"content-area",children:[(0,u.jsx)("div",{className:"content",dangerouslySetInnerHTML:{__html:s.content}}),t.count>1&&(0,u.jsxs)("div",{className:"asp-more-comment",children:["and ",t.count-1," other comments"]})]})]})})]})}const O=(0,a.memo)(P,(function(e,t){return(0,b.wU)(e.reaction,t.reaction)&&e.isAnimate===t.isAnimate}));var k=n(94184),C=n.n(k);function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(e){var t,n=e.icon,r=e.children,o=e.className,i=E((0,a.useState)(!1),2),s=i[0],c=i[1],l=C()("asp-control-switch",(A(t={},o,""!==o),A(t,"hovered",s),t));return(0,u.jsxs)("div",{className:l,onMouseEnter:function(){c(!0)},onMouseLeave:function(){c(!1)},children:[(0,u.jsx)(f,{icon:n}),(0,u.jsx)("div",{className:"asp-control-switch-panel",children:(0,u.jsx)("div",{className:"asp-control-switch-panel-inner",onClick:function(){c(!1)},children:r})})]})}const F=(0,a.memo)(D);function N(e){var t=e.onSpeedChange,n=e.speed;return(0,u.jsx)(F,{className:"asp-speed-control-btn",icon:(0,u.jsx)("span",{className:"asp-control-btn-text-icon",children:n+"x"}),children:(0,u.jsx)("ul",{children:s.Ob.map((function(e){return(0,u.jsx)("li",{className:n===e?"selected":"",onClick:function(){return t(e)},children:e+"x"},e)}))})})}const T=(0,a.memo)(N,(function(e,t){return e.speed===t.speed}));function Z(e){var t=e.currentSec,n=e.duration,r=e.centerd,o=(0,c.z7)(t);return(0,u.jsx)("div",{className:"asp-time ".concat(r?"centerd":""),children:o+" / "+n})}const R=(0,a.memo)(Z);function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e){var t=e.onChange,n=B((0,a.useState)((function(){return void 0!==localStorage["asp-volume"]?Number(localStorage["asp-volume"]):1})),2),r=n[0],o=n[1],i=B((0,a.useState)((function(){return"true"===localStorage["asp-isMuted"]})),2),s=i[0],d=i[1],h=B((0,a.useState)(!1),2),p=h[0],m=h[1],g=(0,a.useRef)(null),y=(0,a.useRef)(0),v=(0,a.useRef)(0);(0,a.useEffect)((function(){t(r)}),[r]),(0,a.useEffect)((function(){localStorage["asp-isMuted"]=s}),[s]);var x=function e(t){t.target.className;(0,c.IY)(t.target,".asp-volume-btn")||(m(!1),document.documentElement.removeEventListener("mouseup",e,!1))},b=s?0:parseFloat(r),w=100*b+"%";return(0,u.jsxs)("div",{className:"asp-volume-btn ".concat(p?"hovered":""),onMouseEnter:function(){m(!0),document.documentElement.addEventListener("mouseup",x,!1)},onMouseLeave:function(e){1!==e.buttons&&(m(!1),document.documentElement.removeEventListener("mouseup",x,!1))},onMouseMove:function(e){if(1===e.buttons){var t=g.current,n=(v.current+(e.pageX-y.current))/t.offsetWidth;n>1&&(n=1),n<0&&(n=0),o(n),0===n&&d(!0)}},children:[(0,u.jsx)(f,{className:"asp-volume-icon",title:s?"Unmute":"Mute",icon:b>.5?(0,u.jsx)(l.Nt,{}):b<=.5&&0!==b?(0,u.jsx)(l.j4,{}):0===b?(0,u.jsx)(l.GK,{}):void 0,onClick:function(){s?(d(!1),0===r&&o(1)):(d(!0),o(0))}}),(0,u.jsx)("div",{className:"asp-volume-progress-panel",ref:g,onMouseDown:function(e){var t=g.current,n=(e.pageX-t.getBoundingClientRect().x)/t.offsetWidth;y.current=e.pageX,v.current=n*t.offsetWidth,n>0&&s&&d(!1),o(n)},children:(0,u.jsx)("div",{className:"asp-volume-progress",children:(0,u.jsx)("div",{className:"asp-volume-current",style:{width:w},children:(0,u.jsx)("div",{className:"asp-volume-indicator"})})})})]})}const U=(0,a.memo)(V);function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=(0,a.forwardRef)((function(e,t){var n=z((0,a.useState)("init"),2),r=n[0],o=n[1],d=z((0,a.useState)(!1),2),h=d[0],m=d[1],g=z((0,a.useState)("init"),2),y=g[0],v=g[1],b=z((0,a.useState)(0),2),w=b[0],j=b[1],S=z((0,a.useState)(!1),2),P=S[0],k=S[1],C=z((0,a.useState)(!1),2),A=C[0],E=C[1],I=z((0,a.useState)(!1),2),D=I[0],F=I[1],N=z((0,a.useState)(!1),2),Z=N[0],B=N[1],L=z((0,a.useState)(!1),2),V=L[0],M=L[1],_=z((0,a.useState)(!1),2),H=_[0],W=_[1],q=z((0,a.useState)(1),2),X=q[0],K=q[1],G=z((0,a.useState)(!1),2),Y=G[0],J=G[1],$=z((0,a.useState)([]),2),Q=$[0],ee=$[1],te=z((0,a.useState)({width:0,height:0}),2),ne=te[0],re=te[1],oe="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,ae=(0,i.useMediaQuery)({query:"(max-width: 650px)"})&&oe,ie=(0,i.useMediaQuery)({query:"(max-width: 410px)"}),se=z((0,a.useState)(!1),2),ce=se[0],le=se[1],ue=(0,a.useRef)(null),de=(0,a.useRef)(null),fe=(0,a.useRef)(),he=(0,a.useRef)(),pe=(0,a.useRef)(!1),me=(0,a.useRef)(null),ge=(0,a.useRef)(!1),ye=(0,a.useRef)(0),ve=(0,a.useRef)(),xe=(0,a.useRef)(!1),be=(0,a.useRef)(!1),we=e.src,je=e.comments,Se=(0,a.useRef)(void 0),Pe=(0,a.useRef)();(0,a.useImperativeHandle)(t,(function(){return{playVideo:Be,seekTo:Re,getCurrentTime:Le,pause:Me}})),(0,a.useEffect)((function(){xe.current=P}),[P]),(0,a.useEffect)((function(){return ue.current.addEventListener("loadedmetadata",Ce,!1),ue.current.addEventListener("ended",Ae,!1),ue.current.addEventListener("timeupdate",Ee,!1),ue.current.addEventListener("waiting",Ie,!1),ue.current.addEventListener("play",De,!1),ue.current.addEventListener("canplay",Fe,!1),ue.current.addEventListener("pause",Ne,!1),ue.current.addEventListener("error",Te,!1),de.current.addEventListener("fullscreenchange",Ze,!1),de.current.addEventListener("webkitfullscreenchange",Ze,!1),document.documentElement.addEventListener("keydown",Oe,!1),function(){ue.current.removeEventListener("loadedmetadata",Ce,!1),ue.current.removeEventListener("ended",Ae,!1),ue.current.removeEventListener("timeupdate",Ee,!1),ue.current.removeEventListener("waiting",Ie,!1),ue.current.removeEventListener("play",De,!1),ue.current.removeEventListener("canplay",Fe,!1),ue.current.removeEventListener("pause",Ne,!1),ue.current.removeEventListener("error",Te,!1),de.current.removeEventListener("fullscreenchange",Ze,!1),de.current.removeEventListener("webkitfullscreenchange",Ze,!1),document.documentElement.removeEventListener("keydown",Oe,!1)}}),[]),(0,a.useEffect)((function(){if(e.comments){var t=ke(je);ee(t)}}),[e.comments]);var Oe=function(e){var t=e.keyCode,n=e.target.tagName,r="true"===e.target.contentEditable;if("TEXTAREA"!==n&&"INPUT"!==n&&!r)switch(e.stopPropagation(),t){case 32:e.preventDefault(),ue.current.paused?ze():Me();break;case 39:ue.current.ended||(j((function(e){return ue.current.currentTime=e+5,e+5})),M(!0));break;case 37:ue.current.ended||(j((function(e){return ue.current.currentTime=e-5,e-5})),W(!0))}},ke=function(e){var t=e.map((function(e){return{id:e.id,isEmoji:e.isEmoji,content:e.content,userAvatar:e.userAvatar,createTime:e.createTime,userName:e.userName,time:e.timestamp,animation:e.animation}})),n={},r=[];for(var o in t.forEach((function(e){1===e.isEmoji?r.push({time:e.time,type:"emoji",comment:e}):n[e.time]?n[e.time].push(e):n[e.time]=[e]})),n)r.push({time:o,type:"comment",comment:n[o][0],count:n[o].length});return r.reverse()},Ce=function(e){he.current=e.target.duration,fe.current=(0,c.z7)(parseInt(e.target.duration)),o("loadedMetadata"),m(!0),re({width:e.target.videoWidth,height:e.target.videoHeight})},Ae=function(){v("ended")},Ee=function(t){pe.current||(j(t.target.currentTime),e.handleVideoTimeChange&&e.handleVideoTimeChange(t.target.currentTime))},Ie=function(){o("waiting")},De=function(){v("playing"),pe.current||F(!0),Ve()},Fe=function(){o("canplay")},Ne=function(){v("paused"),ue.current.currentTime===ue.current.duration||pe.current||B(!0),k(!1)},Te=function(){o("error")},Ze=function(){document.fullscreenElement||document.webkitIsFullScreen?E(!0):E(!1)},Re=function(e){ue.current.currentTime=e,j(e)},Be=function(){"error"===r&&ue.current.load(),ze()},Le=function(){return ue.current.currentTime},Ve=function e(){var t,n;if(pe.current||null!==(t=ue.current)&&void 0!==t&&t.paused||null!==(n=ue.current)&&void 0!==n&&n.ended)ye.current=0;else if(window.requestAnimationFrame(e),(new Date).getTime()-ye.current>=1e3/60&&ue.current){var r=ue.current.currentTime;j(r),ye.current=(new Date).getTime()}},Ue=function(){A?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():de.current.requestFullscreen?de.current.requestFullscreen():de.current.webkitRequestFullscreen?de.current.webkitRequestFullscreen():ue.current.webkitEnterFullscreen&&ue.current.webkitEnterFullscreen()},ze=function(){me.current||(me.current=ue.current.play().then((function(){me.current=null})).catch((function(){me.current=null,Me()}))),Se.current=setTimeout((function(){k(!0),Se.current=void 0}),5e3)},Me=function(){ge.current||(me.current?(ge.current=!0,me.current.then((function(){ue.current&&ue.current.pause(),me.current=null,ge.current=!1}))):ue.current.pause())},_e=function(){v("playing"),j(0),ue.current.currentTime=0,ze(),k(!0)},He=function(e){switch(e){case"forward":M(!1);break;case"back":W(!1);break;case"play":F(!1);break;case"pause":B(!1)}},We=function(t){e.handleReactionIconAnimationEnd&&e.handleReactionIconAnimationEnd(t)},qe=function(t){"comment"===t.type?e.handleScrollToComment&&e.handleScrollToComment(t.comment.id):(Re(t.time),"init"===y&&ze())},Xe=function(){J(!Y),e.handleToggleTheaterMode()};function Ke(e){var t=0;return t=e?Number(e):he.current,(0,u.jsx)("div",{className:"asp-reaction-container",children:Q.map((function(e){var n="";return n=0===Number(e.time)?"11px":e.time/t*de.current.offsetWidth+20>de.current.offsetWidth||Number(e.time)>=t?"calc(100% - 11px)":e.time/t*100+"%",(0,u.jsx)(O,{left:n,reaction:e,isAnimate:Math.ceil(e.time)===Math.ceil(w)&&P,playerRef:de,onReactionAnimationEnd:We,handleOnClick:qe},e.comment.id)}))})}return(0,u.jsxs)("div",{className:"as-video-player ".concat(P&&"paused"!==y?"collapsed":""),ref:de,onMouseLeave:function(){"playing"===y&&(clearTimeout(Se.current),Se.current=setTimeout((function(){k(!0),Se.current=void 0}),350))},onMouseMove:function(){ae||(P&&k(!1),clearTimeout(Se.current),Se.current=void 0,"playing"!==y||be.current||(Se.current=setTimeout((function(){k(!0),Se.current=void 0}),5e3)))},children:[(0,u.jsxs)("div",{className:"asp-video-container",onTouchStart:function(){if("ended"!==y&&(!ce||"paused"!==y)){if(le(!0),k(!1),clearTimeout(Se.current),Se.current=void 0,ce)return le(!1),void k(!0);clearTimeout(Pe.current),Pe.current=setTimeout((function(){le(!1),k(!0)}),2e3)}},children:["ended"===y&&(0,u.jsx)("div",{className:"asp-replay-wrapper",children:(0,u.jsxs)("div",{className:"center",children:[(0,u.jsx)("div",{className:"asp-replay-btn",onClick:_e,children:(0,u.jsx)(l.NK,{})}),e.replayLayer&&(0,u.jsx)("div",{className:"replay-layer",children:e.replayLayer})]})}),ae&&(ce||"paused"===y)&&(0,u.jsx)("div",{className:"asp-mobile-action-wrapper",children:(0,u.jsx)("div",{className:"asp-mobile-play-btn",onTouchStart:function(){"playing"===y?Me():ze()},children:"playing"===y?(0,u.jsx)(l.fp,{}):(0,u.jsx)(l.o1,{})})}),"init"===y&&(0,u.jsxs)("div",{className:"asp-thumbnail-wrapper",children:[(0,u.jsx)("div",{className:"asp-thumbnail-bg"}),(0,u.jsx)("img",{src:e.thumbnailURI,className:"asp-video-thumbnail"}),(0,u.jsx)("div",{className:"play-btn",onClick:function(){e.increaseView&&e.increaseView(),ze()},children:(0,u.jsx)(l.o1,{})}),""!==e.duration||"init"!==r&&"error"!==r?Ke(e.duration):""]}),"error"===r&&(0,u.jsxs)("div",{className:"asp-error-message",children:["Something went wrong. ",(0,u.jsx)("a",{onClick:function(){o("init"),ue.current.load()},children:"Refresh"})]}),("waiting"===r||"init"===r)&&(0,u.jsx)(p,{}),(0,u.jsxs)("div",{className:"video-box",onClick:function(){ae||(ue.current.paused?ze():Me())},onDoubleClick:function(){Ue()},children:[(0,u.jsx)("div",{className:"asp-effect-btn asp-play-effect-btn ".concat(D?"animate":""),onAnimationEnd:function(){He("play")},children:(0,u.jsx)(l.o1,{})}),(0,u.jsx)("div",{className:"asp-effect-btn asp-pause-effect-btn ".concat(Z?"animate":""),onAnimationEnd:function(){He("pause")},children:(0,u.jsx)(l.fp,{})}),(0,u.jsx)("div",{className:"asp-effect-btn asp-forward-effect-btn ".concat(V?"animate":""),onAnimationEnd:function(){He("forward")},children:(0,u.jsx)(l.$E,{})}),(0,u.jsx)("div",{className:"asp-effect-btn asp-back-effect-btn ".concat(H?"animate":""),onAnimationEnd:function(){He("back")},children:(0,u.jsx)(l.Qe,{})}),e.annotationLayer&&(0,u.jsx)("div",{className:"annotation-layer",children:e.annotationLayer(w,ne)}),(0,u.jsx)("video",{id:"main-player",playsInline:!0,preload:"auto",ref:ue,src:we})]})]}),h&&"error"!==r&&(0,u.jsxs)(u.Fragment,{children:[!ae&&(0,u.jsx)("div",{className:"asp-gradient"}),(0,u.jsxs)("div",{className:"asp-control-bar ".concat(P&&"paused"!==y?"collapsed":""),onMouseEnter:function(){clearTimeout(Se.current),Se.current=void 0,be.current=!0},onMouseLeave:function(){be.current=!1},children:[Ke(),(0,u.jsx)(x,{videoRef:ue,duration:he.current,currentSec:w,isCollapsed:P,handlePlayPercentageChange:function(e){j(e*he.current),"ended"===y&&ze()},handleSeekingStart:function(){pe.current=!0,ve.current=y,Me()},handleSeekingEnd:function(){pe.current=!1,Ve(),"paused"!==ve.current&&ze()}}),(0,u.jsxs)("div",{className:"asp-controls",children:[(0,u.jsxs)("div",{className:"asp-left-control",children:[!ae&&(0,u.jsxs)(u.Fragment,{children:["paused"===y&&(0,u.jsx)(f,{className:"asp-play-btn",title:"Play",icon:(0,u.jsx)(l.o1,{}),onClick:ze}),"playing"===y&&(0,u.jsx)(f,{className:"asp-pause-btn",title:"Pause",icon:(0,u.jsx)(l.fp,{}),onClick:Me}),"ended"===y&&(0,u.jsx)(f,{className:"asp-replay-btn",title:"Replay",icon:(0,u.jsx)(l.NK,{}),onClick:_e}),(0,u.jsx)(U,{onChange:function(e){ue.current.volume=e,localStorage["asp-volume"]=e}})]}),(A||ae)&&(0,u.jsx)(R,{currentSec:w,duration:fe.current})]}),!A&&!ae&&(0,u.jsx)(R,{currentSec:w,duration:fe.current,centerd:!0}),A&&e.handleAddReaction&&!ae&&(0,u.jsx)("div",{className:"asp-reaction-button-container",children:s.t5.map((function(t){return(0,u.jsx)("div",{className:"asp-reaction-button",onClick:function(){!function(t){e.handleAddReaction&&e.handleAddReaction(t)}(t)},children:t},t)}))}),(0,u.jsxs)("div",{className:"asp-right-control",children:[!ie&&(0,u.jsx)(T,{speed:X,onSpeedChange:function(e){ue.current.playbackRate=e,K(e)}}),e.handleToggleTheaterMode&&!ae&&(0,u.jsx)(u.Fragment,{children:Y?(0,u.jsx)(f,{title:"Default view",icon:(0,u.jsx)("div",{className:"asp-control-btn-inner-icon asp-default-mode-icon"}),onClick:Xe}):(0,u.jsx)(f,{title:"Theater mode",icon:(0,u.jsx)("div",{className:"asp-control-btn-inner-icon asp-theator-mode-icon"}),onClick:Xe})}),!/Firefox/.test(window.navigator.userAgent)&&(0,u.jsx)(f,{title:"Toggle PIP",icon:(0,u.jsx)(l.ih,{}),onClick:function(){document.pictureInPictureElement?document.exitPictureInPicture():ue.current.requestPictureInPicture&&ue.current.requestPictureInPicture()}}),A?(0,u.jsx)(f,{className:"asp-exitfullscreen-btn",icon:(0,u.jsx)(l.$Z,{}),onClick:Ue,title:"Exit Full screen"}):(0,u.jsx)(f,{className:"asp-fullscreen-btn",onClick:Ue,icon:(0,u.jsx)(l.Xt,{}),title:"Full screen"})]})]})]})]})]})}));_.displayName="AsVideoPlayer",_.propTypes={src:o().string.isRequired,comments:o().array,handleReactionIconAnimationEnd:o().func,handleAddReaction:o().func,handleVideoTimeChange:o().func,increaseView:o().func,handleScrollToComment:o().func,handleToggleTheaterMode:o().func,thumbnailURI:o().string,duration:o().number,annotationLayer:o().func};const H=_},61988:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(67294),o=n(34698),a=n(74183),i=n(85893);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,n,r,d=u(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=d.call(this,e)).dataManager=null,t.annotationCanvas=null,t.anns=[],t.annsHash="",t.onManagerRefer=function(){return t.dataManager},t.onUpdateAnns=function(e){t.annsHash!==e&&(t.anns=t.dataManager.buildAnnsForSimulator(),t.annotationCanvas&&t.annotationCanvas.repaintAnnotations(!0,t.anns))},t.onDbClick=function(){},t.onClick=function(e){if(e.target&&e.target.className&&("string"==typeof e.target.className||"object"==s(e.target.className)&&e.target.className.baseVal)){var t="string"==typeof e.target.className?e.target.className:e.target.className.baseVal;(t.indexOf("video-ann-text-link")>=0||t.indexOf("video-ann-link-ct")>=0||t.indexOf("video-ann-link-tspan")>=0)&&e.stopPropagation()}},t.networkManager=new o.r(t.props.videoID),t.networkManager.resetBaseVersion(e.baseVersion),t.dataManager=new o.P(!0,{ref:t.onManagerRefer,updateAnns:t.onUpdateAnns}),t}return t=f,(n=[{key:"componentDidUpdate",value:function(e){var t=this;this.dataManager&&(e.videoID!==this.props.videoID&&this.dataManager.updateVideo&&this.dataManager.updateVideo(this.props.videoID),e.baseVersion!==this.props.baseVersion&&this.networkManager.resetBaseVersion&&this.networkManager.resetBaseVersion(this.props.baseVersion),this.networkManager&&this.networkManager.canRequestNetwork&&this.networkManager.canRequestNetwork()&&this.networkManager.loadAnnotations(this.props.shareKey,this.props.isOnlyBlurProcessing,(function(e,n,r){e&&(t.dataManager.parseData(n,r),n.actions&&Array.isArray(n.actions)&&t.networkManager.loadImageAnnotationURL(n.actions.filter((function(e){return"image"===e.type})).map((function(e){if(e.contentType)return"image/png"===e.contentType?e.contentImageKey+".png":e.contentImageKey+".jpg";e.contentImageKey})),t.props.shareKey,(function(e,n){e&&t.dataManager.updateImageUrl(n.data)})))})),this.props.currentSec!==e.currentSec&&this.dataManager.repaintAnnotations(this.props.currentSec,""))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;return(0,i.jsx)("div",{className:"annotation-wrapper",id:"annotation-bg",children:(0,i.jsx)(a.Z,{ref:function(t){e.annotationCanvas=t,e.anns&&t&&e.annotationCanvas.repaintAnnotations(!0,e.anns)},scale:1,width:this.props.videoDimension.width,height:this.props.videoDimension.height,onDbClick:this.onDbClick,onClick:this.onClick})})}}])&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.Component)},74183:(e,t,n)=>{n.d(t,{Z:()=>p});var r=n(94184),o=n.n(r),a=n(67294),i=n(85893);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(d,e);var t,n,r,s=u(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=s.call(this,e))._selectedMd5="",t.canvas=null,t.updateProgress=function(e){t.setState({currentTime:e})},t.selectAnnotation=function(e,n){t.selectedAnn&&"blur"==t.selectedAnn.type&&t.canvas.current&&t.selectedAnn.referSimulatorItem.current&&t.canvas.current.prepend(t.selectedAnn.referSimulatorItem.current.getSVGEle()),e&&e.length>0?t.selectedAnn=t.state.anns.find((function(t){return t.md5==e})):t.selectedAnn=void 0,t._selectedMd5=e,t.setState({selectedMd5:e,selectedBlur:n}),t.selectedAnn&&t.canvas.current&&t.selectedAnn.referSimulatorItem.current&&t.canvas.current.append(t.selectedAnn.referSimulatorItem.current.getSVGEle())},t.resetDrawableRect=function(e,n){t.setState({scale:n,videoWidth:e.width,videoHeight:e.height})},t.repaintAnnotations=function(e,n){var r=f(t);t.setState({readonly:e,anns:n},(function(){r._selectedMd5&&r._selectedMd5.length>0&&!r.selectedAnn&&(r.selectedAnn=n.find((function(e){return e.md5==r._selectedMd5})),r.selectedAnn&&r.canvas.current&&r.selectedAnn.referSimulatorItem.current&&setTimeout((function(){var e=r.selectedAnn.referSimulatorItem.current.getSVGEle();r.canvas.current.append(e)}),100))}))},t.state={videoWidth:e.width,videoHeight:e.height,scale:e.scale,selectedMd5:"",selectedBlur:!1,readonly:!1,currentTime:0,anns:[]},t.canvas=(0,a.createRef)(),t}return t=d,r=[{key:"getDerivedStateFromProps",value:function(e,t){var n={};return t.videoWidth!=e.width&&(n.videoWidth=e.width),t.videoHeight!=e.height&&(n.videoHeight=e.height),t.scale!=e.scale&&(n.scale=e.scale),n}}],(n=[{key:"render",value:function(){var e=this,t="0 0 ".concat(this.state.videoWidth," ").concat(this.state.videoHeight);return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:o()("svg-canvas",{selectedBlur:this.state.selectedBlur}),ref:this.canvas,width:this.state.videoWidth,height:this.state.videoHeight,onClick:this.props.onClick,onDoubleClick:this.props.onDbClick,viewBox:t,children:[(0,i.jsxs)("defs",{children:[(0,i.jsxs)("filter",{xmlns:"http://www.w3.org/2000/svg",id:"dropshadow-0",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,i.jsxs)("feComponentTransfer",{in:"SourceAlpha",children:[(0,i.jsx)("feFuncR",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncG",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncB",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncA",{type:"identity",tableValues:"0.4"})]}),(0,i.jsx)("feGaussianBlur",{stdDeviation:"4"}),(0,i.jsx)("feOffset",{dx:"0",dy:"2",result:"shadow"}),(0,i.jsx)("feComposite",{in:"SourceGraphic",in2:"shadow",operator:"over"})]}),(0,i.jsxs)("filter",{xmlns:"http://www.w3.org/2000/svg",id:"dropshadow-1",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,i.jsxs)("feComponentTransfer",{in:"SourceAlpha",children:[(0,i.jsx)("feFuncR",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncG",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncB",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncA",{type:"identity",tableValues:"0.4"})]}),(0,i.jsx)("feGaussianBlur",{stdDeviation:"8"}),(0,i.jsx)("feOffset",{dx:"0",dy:"4",result:"shadow"}),(0,i.jsx)("feComposite",{in:"SourceGraphic",in2:"shadow",operator:"over"})]}),(0,i.jsxs)("filter",{xmlns:"http://www.w3.org/2000/svg",id:"dropshadow-2",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,i.jsxs)("feComponentTransfer",{in:"SourceAlpha",children:[(0,i.jsx)("feFuncR",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncG",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncB",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncA",{type:"identity",tableValues:"0.4"})]}),(0,i.jsx)("feGaussianBlur",{stdDeviation:"12"}),(0,i.jsx)("feOffset",{dx:"0",dy:"6",result:"shadow"}),(0,i.jsx)("feComposite",{in:"SourceGraphic",in2:"shadow",operator:"over"})]}),(0,i.jsxs)("filter",{xmlns:"http://www.w3.org/2000/svg",id:"dropshadow-3",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,i.jsxs)("feComponentTransfer",{in:"SourceAlpha",children:[(0,i.jsx)("feFuncR",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncG",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncB",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncA",{type:"identity",tableValues:"0.4"})]}),(0,i.jsx)("feGaussianBlur",{stdDeviation:"16"}),(0,i.jsx)("feOffset",{dx:"0",dy:"2",result:"shadow"}),(0,i.jsx)("feComposite",{in:"SourceGraphic",in2:"shadow",operator:"over"})]}),(0,i.jsxs)("filter",{xmlns:"http://www.w3.org/2000/svg",id:"dropshadow-4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,i.jsxs)("feComponentTransfer",{in:"SourceAlpha",children:[(0,i.jsx)("feFuncR",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncG",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncB",{type:"discrete",tableValues:"0"}),(0,i.jsx)("feFuncA",{type:"identity",tableValues:"0.4"})]}),(0,i.jsx)("feGaussianBlur",{stdDeviation:"20"}),(0,i.jsx)("feOffset",{dx:"0",dy:"4",result:"shadow"}),(0,i.jsx)("feComposite",{in:"SourceGraphic",in2:"shadow",operator:"over"})]}),(0,i.jsx)("filter",{id:"blur",children:(0,i.jsx)("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"10",result:"blurred"})}),(0,i.jsx)("marker",{id:"arrow-FF0000",markerWidth:"10",markerHeight:"10",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",viewBox:"0 0 10 10",children:(0,i.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#FF0000"})}),(0,i.jsx)("marker",{id:"arrow-FF9900",markerWidth:"10",markerHeight:"10",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",viewBox:"0 0 10 10",children:(0,i.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#FF9900"})}),(0,i.jsx)("marker",{id:"arrow-0072E6",markerWidth:"10",markerHeight:"10",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",viewBox:"0 0 10 10",children:(0,i.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#0072E6"})}),(0,i.jsx)("marker",{id:"arrow-12DC00",markerWidth:"10",markerHeight:"10",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",viewBox:"0 0 10 10",children:(0,i.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#12DC00"})}),(0,i.jsx)("marker",{id:"arrow-CF00FF",markerWidth:"10",markerHeight:"10",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",viewBox:"0 0 10 10",children:(0,i.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#CF00FF"})}),(0,i.jsx)("marker",{id:"arrow-FFFFFF",markerWidth:"10",markerHeight:"10",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",viewBox:"0 0 10 10",children:(0,i.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#FFFFFF"})})]}),this.state.anns.map((function(t){return t&&t.code4Paint?t.code4Paint(e.state.readonly,{retrieveCanvas:function(){return e.canvas?e.canvas.current:null},currentTime:e.state.currentTime,selectedBlur:e.state.selectedBlur,selectedMd5:e._selectedMd5,scale:e.state.scale,onSelect:e.props.onSelect,onDragStart:e.props.onDragStart,onDragEnd:e.props.onDragEnd}):""})),(0,i.jsx)("use",{href:"#-1"})]})}}])&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(a.Component)},34698:(e,t,n)=>{n.d(t,{P:()=>cn,r:()=>sn});n(41318);var r=n(60881),o=(n(94507),n(48086)),a=(n(37135),n(48889)),i=n(57119),s=n(28374),c=n(97474);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var d=u((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canUndo=function(){return t.editActionsUndo&&t.editActionsUndo.length>0},this.canRedo=function(){return t.editActionsRedo&&t.editActionsRedo.length>0},this.doUndo=function(e){var n=t.editActionsUndo.pop();n&&t.editActionsRedo.push(n),e&&e(n)},this.doRedo=function(e){var n=t.editActionsRedo.pop();n&&t.editActionsUndo.push(n),e&&e(n)},this.doClear=function(e){t.editActionsUndo=[],t.editActionsRedo=[],e&&e()},this.doAddNewAction=function(e,n,r,o){t.editActionsUndo.push({actionType:e,md5:n,prevData:o,data:r}),t.editActionsRedo.length>0&&(t.editActionsRedo=[])},this.editActionsUndo=[],this.editActionsRedo=[]}));d.ACTION_TYPE_ADD="ADD",d.ACTION_TYPE_DELETE="DELETE",d.ACTION_TYPE_UPDATE="UPDATE";var f=n(56010),h=n(78718),p=n.n(h),m=n(84141),g=n(9669),y=n.n(g),v=(n(38920),n(32787)),x=n(67294),b=n(94184),w=n.n(b),j=n(66358),S=n(5826),P=n(85893);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}j.p8.registerPlugin(S._);var D=function(e,t){var n=t.createSVGPoint();n.x=e.clientX,n.y=e.clientY;var r=n.matrixTransform(t.getScreenCTM().inverse());return{x:r.x,y:r.y}},F=(0,x.forwardRef)((function(e,t){var n=E((0,x.useState)(null),2),r=n[0],o=n[1],a=E((0,x.useState)(null),2),i=a[0],c=a[1],l=E((0,x.useState)(null),2),u=l[0],d=l[1],f=E((0,x.useState)({width:e.width,height:e.height}),2),h=f[0],p=f[1],g=E((0,x.useState)({left:e.left,top:e.top}),2),y=g[0],b=g[1],O=E((0,x.useState)(e.scale),2),C=O[0],I=O[1],F=E((0,x.useState)(!1),2),N=F[0],T=F[1],Z=null,R=null,B=(0,x.useCallback)((function(t){if(null!==t){o(t);var n=t.querySelector(".video-ann-text-bg");Z=t.querySelector("textarea");var r=function(t){e.onSelect&&e.onSelect(e.md5,(function(e){return!e||(Y(),!1)}))};if(e.readonly)u&&u.disable(),Z&&Z.removeEventListener("click",r);else{var a=-1,s=-1,l=null,f=null,h=null,g=null,y=[];m.Z.isSafari()?((l=t.querySelector(".video-ann-text-ct")).addEventListener("click",r),n.addEventListener("click",r),y=[l,n]):((l=t.querySelector(".video-ann-text-foreign")).addEventListener("click",r),document.activeElement!=Z&&(Z.style.pointerEvents="none"),y=[l]);var v=t.querySelector(".topleft"),x=t.querySelector(".topright"),w=t.querySelector(".bottomleft"),P=t.querySelector(".bottomright");if(null==u){var O=S._.create(y,{type:"x,y",edgeResistance:1,inertia:!1,bounds:document.getElementById("vjs-annotation-bg"),onDrag:function(e){j.p8.to(v,{x:j.p8.getProperty(f,"x"),y:j.p8.getProperty(f,"y"),duration:0}),j.p8.to(x,{x:j.p8.getProperty(f,"x"),y:j.p8.getProperty(f,"y"),duration:0}),j.p8.to(w,{x:j.p8.getProperty(f,"x"),y:j.p8.getProperty(f,"y"),duration:0}),j.p8.to(P,{x:j.p8.getProperty(f,"x"),y:j.p8.getProperty(f,"y"),duration:0}),j.p8.to(n,{x:j.p8.getProperty(f,"x"),y:j.p8.getProperty(f,"y"),duration:0}),j.p8.to(l,{x:j.p8.getProperty(f,"x"),y:j.p8.getProperty(f,"y"),duration:0})},onDragStart:function(t){f=t.target,T(!0),(e.readonly||m.Z.isSafari())&&f&&"tspan"==f.tagName&&(f=l),a=n.x.baseVal.value,s=n.y.baseVal.value;var r=function(e){return e.target&&e.target.parentNode?(t="TEXTAREA"==e.target.nodeName||"tspan"==e.target.nodeName?e.target.parentNode.parentNode.className:e.target.parentNode.className)&&t.baseVal?t.baseVal:t:null;var t}(t);r&&r.indexOf(e.md5)>=0&&e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){var o={left:a+j.p8.getProperty(f,"x"),top:s+j.p8.getProperty(f,"y")};o.x=o.left,o.y=o.top,e.onDragEnd&&e.onDragEnd(t,e.md5,o),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(l,{x:0,y:0,duration:0}),j.p8.to(v,{x:0,y:0,duration:0}),j.p8.to(x,{x:0,y:0,duration:0}),j.p8.to(w,{x:0,y:0,duration:0}),j.p8.to(P,{x:0,y:0,duration:0}),a=s=-1,Z.disabled=!0,l.removeEventListener("click",r),setTimeout((function(){Z.disabled=!1,l.addEventListener("click",r)}),200),f=null,T(!1)}});O&&O.length>0&&d(O[0])}var k=-1,C=-1,E=0,I=0,F=!1,N=!1,B=!1,L=!1,V=e.retrieveCanvas();if(null==i){var U=S._.create(".drag-area-".concat(e.md5),{type:"x,y",edgeResistance:1,intertia:!1,bounds:document.getElementById("vjs-annotation-bg"),onDrag:function(t){if((F||N||B||L)&&f){var n=D(t,V),r=(n.x,n.y,e.minSize);R&&(r=R.resizableTextArea.props.minSize);var o={duration:0},a={x:0,y:0,duration:0},i={x:0,y:0,duration:0},s={x:0,y:0,duration:0},c={x:0,y:0,duration:0};F&&(B?s.x=j.p8.getProperty(f,"x"):a.x=j.p8.getProperty(f,"x"),o.x=E+j.p8.getProperty(f,"x"),o.width=k-j.p8.getProperty(f,"x")),N&&(B?c.x=j.p8.getProperty(f,"x"):i.x=j.p8.getProperty(f,"x"),o.width=k+j.p8.getProperty(f,"x")),B&&(F?i.y=j.p8.getProperty(f,"y"):a.y=j.p8.getProperty(f,"y"),o.y=I+j.p8.getProperty(f,"y"),o.height=C-j.p8.getProperty(f,"y")),L&&(F?c.y=j.p8.getProperty(f,"y"):s.y=j.p8.getProperty(f,"y"),o.height=C+j.p8.getProperty(f,"y")),o.width<=r.width?(o.width=r.width,h={x:0,duration:0},F&&B?(o.x=j.p8.getProperty(x,"cx")-o.width,h.cx=o.x,s.cx=h.cx,s.x=0):F&&L?(o.x=j.p8.getProperty(x,"cx")-o.width,h.cx=o.x,a.cx=h.cx,a.x=0):N&&B?(h.cx=j.p8.getProperty(v,"cx")+o.width,c.cx=h.cx,c.x=0):N&&L&&(h.cx=j.p8.getProperty(w,"cx")+o.width,i.cx=h.cx,i.x=0),j.p8.to(f,h)):h&&(v.style.cx=null,x.style.cx=null,w.style.cx=null,P.style.cx=null),o.height<=r.height?(o.height=r.height,g={y:0,duration:0},F&&B?(o.y=j.p8.getProperty(w,"cy")-o.height,g.cy=o.y,i.cy=g.cy,i.y=0):F&&L?(g.cy=j.p8.getProperty(v,"cy")+o.height,c.cy=g.cy,c.y=0):N&&B?(o.y=j.p8.getProperty(w,"cy")-o.height,g.cy=o.y,a.cy=g.cy,a.y=0):N&&L&&(g.cy=j.p8.getProperty(x,"cy")+o.height,s.cy=g.cy,s.y=0),j.p8.to(f,g)):g&&(v.style.cy=null,x.style.cy=null,w.style.cy=null,P.style.cy=null),p({width:o.width,height:o.height}),b({left:o.x?o.x:E,top:o.y?o.y:I}),v!=f&&j.p8.to(v,a),x!=f&&j.p8.to(x,i),w!=f&&j.p8.to(w,s),P!=f&&j.p8.to(P,c)}else U.forEach((function(e,t){e.endDrag()}))},onDragStart:function(t,r,o,a,i){f=t.target,T(!0);var s=t.target.className;"object"==A(s)&&(s=s.baseVal),k=n.width.animVal.value,C=n.height.animVal.value,E=n.x.animVal.value,I=n.y.animVal.value,F=s.indexOf("left")>=0,N=s.indexOf("right")>=0,B=s.indexOf("top")>=0,L=s.indexOf("bottom")>=0,e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){k=C=-1,F=N=B=L=!1;var r={x:n.x.baseVal.value+j.p8.getProperty(n,"x"),y:n.y.baseVal.value+j.p8.getProperty(n,"y"),width:j.p8.getProperty(n,"width"),height:j.p8.getProperty(n,"height")};r.left=r.x,r.top=r.y,e.onDragEnd&&e.onDragEnd(t,e.md5,r,!0),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(l,{x:0,y:0,duration:0}),j.p8.to(v,{x:0,y:0,duration:0}),v.style="transform-origin: 0px 0px; touch-action: none; user-select: none;",j.p8.to(x,{x:0,y:0,duration:0}),x.style="transform-origin: 0px 0px; touch-action: none; user-select: none;",j.p8.to(w,{x:0,y:0,duration:0}),w.style="transform-origin: 0px 0px; touch-action: none; user-select: none;",j.p8.to(P,{x:0,y:0,duration:0}),P.style="transform-origin: 0px 0px; touch-action: none; user-select: none;",f=null,g=null,h=null,T(!1)}});U&&U.length>0&&c(U)}j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(l,{x:0,y:0,duration:0}),j.p8.to(v,{x:0,y:0,duration:0}),j.p8.to(x,{x:0,y:0,duration:0}),j.p8.to(w,{x:0,y:0,duration:0}),j.p8.to(P,{x:0,y:0,duration:0})}}}),[e.isLittleMode,e.readonly]),L=(0,x.useCallback)((function(e){e&&(R=e)}),[e.md5,e.current]),V=E((0,x.useState)(e.show),2),U=V[0],z=V[1],M=E((0,x.useState)(e.content),2),_=M[0],H=M[1],W=E((0,x.useState)(e.format),2),q=W[0],X=W[1],K=function(){z(!0)},G=function(){z(!1)},Y=function(){if(!N){var t=document.querySelector("#video-ann-"+e.md5);t&&document.activeElement!=t&&(t.focus(),t&&(t.style.pointerEvents="auto"),t.selectionStart==t.selectionEnd&&0==t.selectionEnd&&t.setSelectionRange(t.value.length,t.value.length))}},J=function(e,t,n){null!=n.content&&null!=n.content&&H(n.content),n.format&&X(n.format),I(e),p({width:t.width,height:t.height}),b({left:n.left,top:n.top})},$=function(){var t=r.cloneNode(!0);t.setAttribute("transform","matrix(1,0,0,1,0,0)"),t.style.opacity=1;var n=t.querySelector(".video-ann-text-foreign");t.removeChild(n),t.querySelectorAll(".select-circle").forEach((function(e,n){t.removeChild(e)}));var o=t.querySelector(".video-ann-text-bg");return o.setAttribute("x",0),o.setAttribute("y",0),o.setAttribute("ry",e.borderRadius),o.setAttribute("rx",e.borderRadius),o.setAttribute("style","filter:url(#dropshadow-".concat(e.assistIndex,")")),t.querySelectorAll("tspan").forEach((function(e,t){e.setAttribute("x",parseInt(e.getAttribute("x"))-y.left),e.setAttribute("y",parseInt(e.getAttribute("y"))-y.top)})),t.querySelector(".video-ann-text-ct").setAttribute("style",""),t};(0,x.useImperativeHandle)(t,(function(){return{refreshUI:J,getSVGEle:function(){return r},outerHTML:$,focus:Y,show:K,hide:G}}));var Q=q.color,ee="transparent";q.bgColor?ee=q.bgColor:q.isBg&&(ee=Q,Q="white");var te=e.isLink?"Insert a link":"Enter text here";e.isLink&&document.activeElement&&"video-ann-link-title-textarea"==document.activeElement.id&&(te="Add link text");var ne=[];_&&_.length>0&&(ne=_.split("\n")),ne.length<=0&&e.readonly&&ne.push(te);var re="4px ".concat(e.txtDispOffsetX,"px");if(m.Z.isSafari()){var oe=s.ZP.round(e.txtDispOffsetX/C,1);re="1px ".concat(oe,"px")}var ae=6*C;ae<6&&(ae=6);var ie=0,se=0,ce="start",le=0;return"center"==q.align[1]?ie=(h.height-e.minSize.height)/2:"bottom"==q.align[1]&&(ie=h.height-e.minSize.height),"center"==q.align[0]?(se=(h.width-e.minSize.width)/2,ce="middle",le=y.left+h.width/2):"right"==q.align[0]?(se=h.width-e.minSize.width,ce="end",le=y.left+h.width-e.txtDispOffsetX):le=y.left+e.txtDispOffsetX+se,(0,P.jsxs)("g",{className:w()("video-ann",e.md5,{show:U,isLink:e.isLink,readonly:e.readonly,selected:e.current==e.md5}),style:{opacity:e.selectedBlur?.1:1},ref:B,id:"svg-g-".concat(e.md5),children:[(0,P.jsx)("rect",{className:"video-ann-text-bg",x:y.left,y:y.top,rx:e.borderRadius,ry:e.borderRadius,strokeWidth:e.borderWidth,stroke:ee,min:1,max:10,value:9,style:{filter:"url(#dropshadow-".concat(e.assistIndex,")")},width:h.width,height:h.height,fill:ee}),e.readonly&&e.isLink?(0,P.jsx)("a",{xmlns:"http://www.w3.org/1999/xhtml",className:w()("video-ann-text-link","ct-"+Q.substring(1)),xlinkTitle:e.link,type:"link",target:"_blank",xlinkHref:e.link,children:(0,P.jsx)("text",{className:"video-ann-link-ct",fill:Q,fontFamily:q.fontFamily,fontSize:q.size,fontWeight:q.bold||"transparent"==ee?"900":"normal",fontStyle:q.italy?"italic":"normal",children:ne.map((function(t,n){return(0,P.jsx)("tspan",{className:"video-ann-link-tspan",stroke:"#FFFFFF"==Q?"black":"white",strokeWidth:"transparent"==ee?e.strokeWidth:0,textAnchor:ce,style:{textDecoration:e.isLink?"underline":"none"},x:le,y:y.top+e.txtDispOffsetY+n*q.size*1.5+ie+4,children:t},n)}))})}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("text",{className:"video-ann-text-ct",fill:Q,style:{display:e.readonly||m.Z.isSafari()?"block":"none"},fontFamily:q.fontFamily,fontSize:q.size,fontWeight:q.bold||"transparent"==ee?"900":"normal",fontStyle:q.italy?"italic":"normal",children:ne.map((function(t,n){return(0,P.jsx)("tspan",{stroke:"#FFFFFF"==Q?"black":"white",strokeWidth:"transparent"==ee?e.strokeWidth:0,textAnchor:ce,style:{textDecoration:e.isLink?"underline":"none"},x:le,y:y.top+e.txtDispOffsetY+n*q.size*1.5+ie+4,children:t},n)}))}),(0,P.jsx)("foreignObject",{x:y.left,y:y.top,className:"video-ann-text-foreign",width:h.width,height:h.height,strokeWidth:e.borderWidth,stroke:"transparent",style:{display:e.readonly||m.Z.isSafari()?"none":"block"},fill:ee,children:(0,P.jsx)(v.Z.TextArea,{placeholder:te,className:w()("video-ann-text-textarea","ct-"+Q.substring(1)),id:"video-ann-".concat(e.md5),spellCheck:"false",tabIndex:5e3,style:{color:Q,textDecoration:e.isLink?"underline ".concat(e.underlineWidth,"px ").concat(Q):"none",fontFamily:q.fontFamily,fontSize:q.size,textAlign:q.align[0],padding:re,paddingTop:4+ie,overflow:"auto",whiteSpace:"pre",background:ee,WebkitTextStroke:"transparent"==ee?"".concat(e.strokeWidth,"#FFFFFF"==Q?"px #000000":"px #ffffff"):"unset",fontWeight:q.bold||"transparent"==ee?"900":"normal",fontStyle:q.italy?"italic":"normal"},readOnly:e.current!=e.md5,ref:L,minSize:k({},e.minSize),value:_,onFocus:function(){u&&u.disable()},onBlur:function(e){u&&u.enable(),e.target.style.pointerEvents="none"},onChange:function(t){e.handleChangeCt(t.target.value)}})})]}),(0,P.jsx)("circle",{className:w()("select-circle topleft","drag-area-".concat(e.md5)),r:ae,cx:e.left,cy:e.top}),(0,P.jsx)("circle",{className:w()("select-circle topright","drag-area-".concat(e.md5)),r:ae,cx:e.left+e.width,cy:e.top}),(0,P.jsx)("circle",{className:w()("select-circle bottomright","drag-area-".concat(e.md5)),r:ae,cx:e.left+e.width,cy:e.top+e.height}),(0,P.jsx)("circle",{className:w()("select-circle bottomleft","drag-area-".concat(e.md5)),r:ae,cx:e.left,cy:e.top+e.height})]},e.md5)})),N=(0,x.forwardRef)((function(e,t){var n=E((0,x.useState)(e.show),2),r=n[0],o=n[1],a=E((0,x.useState)(null),2),i=a[0],s=a[1],c=E((0,x.useState)(null),2),l=c[0],u=c[1],d=E((0,x.useState)(e.format.blur),2),f=d[0],h=d[1],p=E((0,x.useState)({x:e.x,y:e.y}),2),g=p[0],y=p[1],v=null!=document.fullscreenElement,b=e.retrieveCanvas();m.Z.isFirefox()&&(0,x.useEffect)((function(){document.onfullscreenchange=function(e){var t=i.querySelector(".video-ann-blur-foreign");j.p8.to(t,{x:0,y:0,duration:0})}}),[i]);var O=(0,x.useCallback)((function(t){if(null!==t){s(t);var n=t.querySelector(".video-ann-blur-bg"),r=t.querySelector(".video-ann-blur-foreign"),o=t.querySelector(".topleft"),a=t.querySelector(".topright"),i=t.querySelector(".bottomleft"),c=t.querySelector(".bottomright");if(r||(r=n),e.readonly||v)l&&l.disable();else{var d=S._.create([n,r],{type:"x,y",edgeResistance:1,bounds:b,cursor:"move",activeCursor:"move",onClick:function(){e.onSelect(e.md5)},onDrag:function(e){j.p8.to(o,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(a,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(i,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(c,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(r,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),m.Z.isFirefox()&&y({x:n.x.baseVal.value+j.p8.getProperty(n,"x"),y:n.y.baseVal.value+j.p8.getProperty(n,"y")})},onDragStart:function(t,n,r,o,a){var i=D(t,b);i.x,i.y;e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){var s=j.p8.getProperty(n,"x"),l=j.p8.getProperty(n,"y"),u=j.p8.getProperty(n,"width"),d=j.p8.getProperty(n,"height");"object"==A(u)&&(u=u.baseVal.value),"object"==A(d)&&(d=d.baseVal.value),"object"==A(s)&&(s=s.baseVal.value),"object"==A(l)&&(l=l.baseVal.value);var f={x:n.x.baseVal.value+s,y:n.y.baseVal.value+l,width:u,height:d};f.left=f.x,f.top=f.y,f.right=f.x+f.width,f.bottom=f.y+f.height,e.onDragEnd&&e.onDragEnd(t,e.md5,f),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(r,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0})}});u(d[0]),j.p8.to(n,{x:0,y:0,duration:0});var f=-1,h=-1,p=!1,g=!1,x=!1,w=!1,P=null,O=null,k=S._.create(".drag-area-".concat(e.md5),{type:"x,y",edgeResistance:1,intertia:!1,bounds:document.getElementById("vjs-annotation-bg"),onDrag:function(e){if((p||g||x||w)&&P){var t=D(e,b),s=(t.x,t.y,{duration:0}),l={x:0,y:0,duration:0},u={x:0,y:0,duration:0},d={x:0,y:0,duration:0},v={x:0,y:0,duration:0};if(p&&(x?d.x=j.p8.getProperty(P,"x"):l.x=j.p8.getProperty(P,"x"),s.x=j.p8.getProperty(P,"x"),s.width=f-s.x),g&&(x?v.x=j.p8.getProperty(P,"x"):u.x=j.p8.getProperty(P,"x"),s.width=f+j.p8.getProperty(P,"x")),x&&(p?u.y=j.p8.getProperty(P,"y"):l.y=j.p8.getProperty(P,"y"),s.y=j.p8.getProperty(P,"y"),s.height=h-s.y),w&&(p?v.y=j.p8.getProperty(P,"y"):d.y=j.p8.getProperty(P,"y"),s.height=h+j.p8.getProperty(P,"y")),s.width<=32||s.height<=32)return null==O&&(O={x:0,y:0,duration:0},p&&x?(O.x=j.p8.getProperty(n,"x"),O.y=j.p8.getProperty(n,"y")):p&&w?(O.x=j.p8.getProperty(n,"x"),O.y=j.p8.getProperty(c,"y")):g&&x?(O.x=j.p8.getProperty(c,"x"),O.y=j.p8.getProperty(n,"y")):g&&w&&(O.x=j.p8.getProperty(a,"x"),O.y=j.p8.getProperty(i,"y"))),void j.p8.to(P,O);O=null,m.Z.isFirefox()&&y({x:n.x.baseVal.value+j.p8.getProperty(n,"x"),y:n.y.baseVal.value+j.p8.getProperty(n,"y")}),j.p8.to(n,s),j.p8.to(r,s),o!=P&&j.p8.to(o,l),a!=P&&j.p8.to(a,u),i!=P&&j.p8.to(i,d),c!=P&&j.p8.to(c,v)}else k.forEach((function(e,t){e.endDrag()}))},onDragStart:function(t,r,o,a,i){P=t.target;var s=t.target.className;"object"==A(s)&&(s=s.baseVal),f=n.width.animVal.value,h=n.height.animVal.value,p=s.indexOf("left")>=0,g=s.indexOf("right")>=0,x=s.indexOf("top")>=0,w=s.indexOf("bottom")>=0,e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(s){f=h=-1,p=g=x=w=!1;var l={x:n.x.baseVal.value+j.p8.getProperty(n,"x"),y:n.y.baseVal.value+j.p8.getProperty(n,"y"),width:j.p8.getProperty(n,"width"),height:j.p8.getProperty(n,"height")};l.left=l.x,l.top=l.y,l.right=l.x+l.width,l.bottom=l.y+l.height,e.onDragEnd&&e.onDragEnd(s,e.md5,l,!0),j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(r,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0}),P=null}});j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0})}}}),[e.readonly,v]),k=function(){o(!0)},C=function(){o(!1)},I=function(e){h(e)},F=function(){return i.cloneNode(!0).querySelector(".video-ann-blur-foreign")};(0,x.useImperativeHandle)(t,(function(){return{refreshUI:I,getSVGEle:function(){return i},outerHTML:F,show:k,hide:C}}));var N=6*e.scale;return N<6&&(N=6),(0,P.jsxs)("g",{className:w()("video-ann",e.md5,{show:r,readonly:e.readonly||v,selected:e.current==e.md5}),ref:O,children:[m.Z.isSafari()?"":(0,P.jsx)("foreignObject",{className:"video-ann-blur-foreign",x:e.x,y:e.y,width:e.width,height:e.height,children:(0,P.jsx)("div",{xmlns:"http://www.w3.org/1999/xhtml",className:"video-ann-blur-div",style:{background:m.Z.isFirefox()?"".concat(0-g.x,"px ").concat(0-g.y,"px no-repeat -moz-element(#").concat(e.readonly?"main-player":"video-player_html5_api",")"):"",backdropFilter:"blur(".concat(f,"px)"),WebkitBackdropFilter:"blur(".concat(f,"px)"),filter:"blur(".concat(f,"px)")}})}),(0,P.jsx)("rect",{className:"video-ann-blur-bg",x:e.x,y:e.y,height:e.height,width:e.width,style:{strokeDasharray:"4, 6",opacity:e.current==e.md5||m.Z.isSafari()?1:0},rx:0,ry:0,strokeWidth:.5,stroke:m.Z.isSafari()?"transparent":"black",fill:m.Z.isSafari()?"#FFFFFF":"transparent"}),(0,P.jsx)("circle",{className:w()("select-circle topleft","drag-area-".concat(e.md5)),r:N,cx:e.x,cy:e.y}),(0,P.jsx)("circle",{className:w()("select-circle topright","drag-area-".concat(e.md5)),r:N,cx:e.x+e.width,cy:e.y}),(0,P.jsx)("circle",{className:w()("select-circle bottomright","drag-area-".concat(e.md5)),r:N,cx:e.x+e.width,cy:e.y+e.height}),(0,P.jsx)("circle",{className:w()("select-circle bottomleft","drag-area-".concat(e.md5)),r:N,cx:e.x,cy:e.y+e.height})]},e.md5)})),T=(0,x.forwardRef)((function(e,t){var n=E((0,x.useState)(e.show),2),r=n[0],o=n[1],a=E((0,x.useState)(e.format.alpha),2),i=a[0],s=a[1],c=E((0,x.useState)(e.format.color),2),l=c[0],u=c[1],d=E((0,x.useState)(e.format.border),2),f=d[0],h=d[1],p=E((0,x.useState)(e.format.shadow),2),m=p[0],g=p[1],y=E((0,x.useState)(null),2),v=y[0],b=y[1],O=E((0,x.useState)(null),2),k=O[0],C=O[1],I=e.retrieveCanvas(),F=(0,x.useCallback)((function(t){if(null!==t){b(t);var n=t.querySelector(".video-ann-image-bg"),r=t.querySelector(".video-ann-image-ct"),o=t.querySelector(".topleft"),a=t.querySelector(".topright"),i=t.querySelector(".bottomleft"),s=t.querySelector(".bottomright");if(e.readonly)k&&k.disable();else{var c=f>0&&!e.showPlaceholder?n:r,l=S._.create(c,{type:"x,y",edgeResistance:1,bounds:I,cursor:"move",activeCursor:"move",onClick:function(){e.onSelect(e.md5)},onDrag:function(e){j.p8.to(o,{x:j.p8.getProperty(c,"x"),y:j.p8.getProperty(c,"y"),duration:0}),j.p8.to(r,{x:j.p8.getProperty(c,"x"),y:j.p8.getProperty(c,"y"),duration:0}),j.p8.to(a,{x:j.p8.getProperty(c,"x"),y:j.p8.getProperty(c,"y"),duration:0}),j.p8.to(i,{x:j.p8.getProperty(c,"x"),y:j.p8.getProperty(c,"y"),duration:0}),j.p8.to(s,{x:j.p8.getProperty(c,"x"),y:j.p8.getProperty(c,"y"),duration:0}),j.p8.to(n,{x:j.p8.getProperty(c,"x"),y:j.p8.getProperty(c,"y"),duration:0})},onDragStart:function(t,n,r,o,a){var i=D(t,I);i.x,i.y;e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){var c=j.p8.getProperty(r,"x"),l=j.p8.getProperty(r,"y"),u=j.p8.getProperty(r,"width"),d=j.p8.getProperty(r,"height");"object"==A(u)&&(u=u.baseVal.value),"object"==A(d)&&(d=d.baseVal.value),"object"==A(c)&&(c=c.baseVal.value),"object"==A(l)&&(l=l.baseVal.value);var f={x:r.x.baseVal.value+c,y:r.y.baseVal.value+l,width:u,height:d};f.left=f.x,f.top=f.y,f.right=f.x+f.width,f.bottom=f.y+f.height,e.onDragEnd&&e.onDragEnd(t,e.md5,f),j.p8.to(r,{x:0,y:0,duration:0}),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(s,{x:0,y:0,duration:0})}});C(l[0]),j.p8.to(r,{x:0,y:0,duration:0});var u=-1,d=-1,h=!1,p=!1,m=!1,g=!1,y=null,v=null,x=S._.create(".drag-area-".concat(e.md5),{type:"x,y",edgeResistance:1,intertia:!1,bounds:document.getElementById("vjs-annotation-bg"),onDrag:function(t){if((h||p||m||g)&&y){var c=D(t,I),l=(c.x,c.y,{duration:0}),b={x:0,y:0,duration:0},w={x:0,y:0,duration:0},S={x:0,y:0,duration:0},P={x:0,y:0,duration:0};h&&(l.x=j.p8.getProperty(y,"x"),l.width=u-l.x),p&&(l.width=u+j.p8.getProperty(y,"x")),m&&(l.y=j.p8.getProperty(y,"y"),l.height=d-l.y),g&&(l.height=d+j.p8.getProperty(y,"y"));var O=e.imageSize.width/l.width,k=e.imageSize.height/l.height,C=O<k?O:k,A=e.imageSize.width/C,E=e.imageSize.height/C,F=A-l.width,N=E-l.height;if(h&&(m?(S.x=j.p8.getProperty(y,"x")-F,b.x=S.x,b.y=j.p8.getProperty(y,"y")-N,w.y=b.y):(b.x=j.p8.getProperty(y,"x")-F,S.x=b.x,S.y=j.p8.getProperty(y,"y")+N,P.y=S.y),l.x=b.x,l.y=b.y),p&&(m?(P.x=j.p8.getProperty(y,"x")+F,w.x=P.x,w.y=j.p8.getProperty(y,"y")-N,b.y=w.y,l.y=w.y):(w.x=j.p8.getProperty(y,"x")+F,P.x=w.x,P.y=j.p8.getProperty(y,"y")+N,S.y=P.y)),l.width=A,l.height=E,l.width<=6||l.height<=6)return null==v&&(v={x:0,y:0,duration:0},h&&m?(v.x=j.p8.getProperty(r,"x"),v.y=j.p8.getProperty(r,"y")):h&&g?(v.x=j.p8.getProperty(r,"x"),v.y=j.p8.getProperty(s,"y")):p&&m?(v.x=j.p8.getProperty(s,"x"),v.y=j.p8.getProperty(r,"y")):p&&g&&(v.x=j.p8.getProperty(a,"x"),v.y=j.p8.getProperty(i,"y"))),void j.p8.to(y,v);v=null,j.p8.to(r,l),n&&j.p8.to(n,{duration:0,x:l.x,y:l.y,height:l.height+f,width:l.width+f}),j.p8.to(o,b),j.p8.to(a,w),j.p8.to(i,S),j.p8.to(s,P)}else x.forEach((function(e,t){e.endDrag()}))},onDragStart:function(t,n,o,a,i){y=t.target;var s=t.target.className;"object"==A(s)&&(s=s.baseVal),u=r.width.animVal.value,d=r.height.animVal.value,h=s.indexOf("left")>=0,p=s.indexOf("right")>=0,m=s.indexOf("top")>=0,g=s.indexOf("bottom")>=0,e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(c){u=d=-1,h=p=m=g=!1;var l={x:r.x.baseVal.value+j.p8.getProperty(r,"x"),y:r.y.baseVal.value+j.p8.getProperty(r,"y"),width:j.p8.getProperty(r,"width"),height:j.p8.getProperty(r,"height")};l.left=l.x,l.top=l.y,l.right=l.x+l.width,l.bottom=l.y+l.height,e.onDragEnd&&e.onDragEnd(c,e.md5,l,!0),j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(r,{x:0,y:0,duration:0}),n&&j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(s,{x:0,y:0,duration:0}),y=null}});j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(s,{x:0,y:0,duration:0})}}}),[e.readonly,e.imageSize,f,e.showPlaceholder]),N=function(){o(!0)},T=function(){o(!1)},Z=function(e,t,n,r){s(e),h(t||0),u(n||0),g(r||0)};(0,x.useImperativeHandle)(t,(function(){return{refreshUI:Z,getSVGEle:function(){return v},show:N,hide:T}}));var R=6*e.scale;return R<6&&(R=6),(0,P.jsxs)("g",{className:w()("video-ann",e.md5,{show:r,readonly:e.readonly,selected:e.current==e.md5}),style:{opacity:e.selectedBlur?.1:1},ref:F,children:[(0,P.jsx)("image",{href:e.showPlaceholder?"../images/svg/pic_loading.svg":e.imageURL,className:"video-ann-image-ct",style:{filter:m>0?"url(#dropshadow-".concat(m-1+Math.floor(f/4),")"):"",opacity:i},x:e.left,y:e.top,height:e.height,width:e.width}),!e.showPlaceholder&&f>0?(0,P.jsx)("rect",{className:"video-ann-image-bg",x:e.left-f/2,y:e.top-f/2,height:e.height+f,width:e.width+f,rx:0,ry:0,strokeWidth:f+2,stroke:l,fill:"transparent"}):"",(0,P.jsx)("circle",{className:w()("select-circle topleft","drag-area-".concat(e.md5)),r:R,cx:e.left,cy:e.top}),(0,P.jsx)("circle",{className:w()("select-circle topright","drag-area-".concat(e.md5)),r:R,cx:e.left+e.width,cy:e.top}),(0,P.jsx)("circle",{className:w()("select-circle bottomright","drag-area-".concat(e.md5)),r:R,cx:e.left+e.width,cy:e.top+e.height}),(0,P.jsx)("circle",{className:w()("select-circle bottomleft","drag-area-".concat(e.md5)),r:R,cx:e.left,cy:e.top+e.height})]},e.md5)})),Z=(0,x.forwardRef)((function(e,t){var n=E((0,x.useState)(e.show),2),r=n[0],o=n[1],a=E((0,x.useState)(null),2),i=a[0],s=a[1],c=E((0,x.useState)(null),2),l=c[0],u=c[1],d=E((0,x.useState)(e.format.color),2),f=d[0],h=d[1],p=E((0,x.useState)(e.format.weight),2),m=p[0],g=p[1],y=m/2,v=(0,x.useCallback)((function(t){if(null!==t){s(t);var n=t.querySelector(".video-ann-rect-bg"),r=e.retrieveCanvas(),o=t.querySelector(".topleft"),a=t.querySelector(".topright"),i=t.querySelector(".bottomleft"),c=t.querySelector(".bottomright"),d=m/2;if(e.readonly)l&&l.disable();else{var f=S._.create(n,{type:"x,y",edgeResistance:1,bounds:r,cursor:"move",activeCursor:"move",onClick:function(){e.onSelect(e.md5)},onDrag:function(e){j.p8.to(o,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(a,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(i,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(c,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0})},onDragStart:function(t,n,o,a,i){var s=D(t,r);s.x,s.y;e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){var r=j.p8.getProperty(n,"x"),s=j.p8.getProperty(n,"y"),l=j.p8.getProperty(n,"width"),u=j.p8.getProperty(n,"height");"object"==A(l)&&(l=l.baseVal.value),"object"==A(u)&&(u=u.baseVal.value),"object"==A(r)&&(r=r.baseVal.value),"object"==A(s)&&(s=s.baseVal.value);var f={x:n.x.baseVal.value+r-d,y:n.y.baseVal.value+s-d,width:l+m,height:u+m};f.left=f.x,f.top=f.y,f.right=f.x+f.width,f.bottom=f.y+f.height,e.onDragEnd&&e.onDragEnd(t,e.md5,f),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0})}});u(f[0]),j.p8.to(n,{x:0,y:0,duration:0});var h=-1,p=-1,g=!1,y=!1,v=!1,x=!1,b=null,w=null,P=S._.create(".drag-area-".concat(e.md5),{type:"x,y",edgeResistance:1,intertia:!1,bounds:document.getElementById("vjs-annotation-bg"),onDrag:function(e){if((g||y||v||x)&&b){var t=D(e,r),s=(t.x,t.y,{duration:0}),l={x:0,y:0,duration:0},u={x:0,y:0,duration:0},d={x:0,y:0,duration:0},f={x:0,y:0,duration:0};if(g&&(v?d.x=j.p8.getProperty(b,"x"):l.x=j.p8.getProperty(b,"x"),s.x=j.p8.getProperty(b,"x"),s.width=h-s.x),y&&(v?f.x=j.p8.getProperty(b,"x"):u.x=j.p8.getProperty(b,"x"),s.width=h+j.p8.getProperty(b,"x")),v&&(g?u.y=j.p8.getProperty(b,"y"):l.y=j.p8.getProperty(b,"y"),s.y=j.p8.getProperty(b,"y"),s.height=p-s.y),x&&(g?f.y=j.p8.getProperty(b,"y"):d.y=j.p8.getProperty(b,"y"),s.height=p+j.p8.getProperty(b,"y")),s.width<=6||s.height<=6)return null==w&&(w={x:0,y:0,duration:0},g&&v?(w.x=j.p8.getProperty(n,"x"),w.y=j.p8.getProperty(n,"y")):g&&x?(w.x=j.p8.getProperty(n,"x"),w.y=j.p8.getProperty(c,"y")):y&&v?(w.x=j.p8.getProperty(c,"x"),w.y=j.p8.getProperty(n,"y")):y&&x&&(w.x=j.p8.getProperty(a,"x"),w.y=j.p8.getProperty(i,"y"))),void j.p8.to(b,w);w=null,j.p8.to(n,s),o!=b&&j.p8.to(o,l),a!=b&&j.p8.to(a,u),i!=b&&j.p8.to(i,d),c!=b&&j.p8.to(c,f)}else P.forEach((function(e,t){e.endDrag()}))},onDragStart:function(t,r,o,a,i){b=t.target;var s=t.target.className;"object"==A(s)&&(s=s.baseVal),h=n.width.animVal.value,p=n.height.animVal.value,g=s.indexOf("left")>=0,y=s.indexOf("right")>=0,v=s.indexOf("top")>=0,x=s.indexOf("bottom")>=0,e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(r){h=p=-1,g=y=v=x=!1;var s={x:n.x.baseVal.value+j.p8.getProperty(n,"x")-d,y:n.y.baseVal.value+j.p8.getProperty(n,"y")-d,width:j.p8.getProperty(n,"width")+m,height:j.p8.getProperty(n,"height")+m};s.left=s.x,s.top=s.y,s.right=s.x+s.width,s.bottom=s.y+s.height,e.onDragEnd&&e.onDragEnd(r,e.md5,s,!0),j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0}),b=null}});j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0})}}}),[e.readonly,m]),b=function(){o(!0)},O=function(){o(!1)},k=function(e,t){h(t.format.color),y=t.format.weight/2,g(t.format.weight)},C=function(){var e=i.cloneNode(!0).querySelector(".video-ann-rect-bg");return e.setAttribute("x",y),e.setAttribute("y",y),e.setAttribute("style",""),e};(0,x.useImperativeHandle)(t,(function(){return{refreshUI:k,outerHTML:C,getSVGEle:function(){return i},show:b,hide:O}}));var I=6*e.scale;return I<m&&(I=m),(0,P.jsxs)("g",{className:w()("video-ann",e.md5,{show:r,readonly:e.readonly,selected:e.current==e.md5}),ref:v,style:{opacity:e.selectedBlur?.1:1},children:[(0,P.jsx)("rect",{className:w()("video-ann-rect-bg"),x:e.x+y,y:e.y+y,rx:2,ry:2,width:e.width-m,height:e.height-m,stroke:f,style:{width:e.width-m,height:e.height-m},strokeWidth:m,fill:"transparent"}),(0,P.jsx)("circle",{className:w()("select-circle topleft","drag-area-".concat(e.md5)),r:I,cx:e.x+y,cy:e.y+y}),(0,P.jsx)("circle",{className:w()("select-circle topright","drag-area-".concat(e.md5)),r:I,cx:e.x+e.width-y,cy:e.y+y}),(0,P.jsx)("circle",{className:w()("select-circle bottomright","drag-area-".concat(e.md5)),r:I,cx:e.x+e.width-y,cy:e.y+e.height-y}),(0,P.jsx)("circle",{className:w()("select-circle bottomleft","drag-area-".concat(e.md5)),r:I,cx:e.x+y,cy:e.y+e.height-y})]},e.md5)})),R=(0,x.forwardRef)((function(e,t){var n=E((0,x.useState)(e.show),2),r=n[0],o=n[1],a=E((0,x.useState)(null),2),i=a[0],s=a[1],c=E((0,x.useState)(null),2),l=c[0],u=c[1],d=E((0,x.useState)(e.format.color),2),f=d[0],h=d[1],p=E((0,x.useState)(e.format.weight),2),m=p[0],g=p[1],y=m/2,v=(0,x.useCallback)((function(t){if(null!==t){s(t);var n=t.querySelector(".video-ann-ellipse-bg");y=m/2;var r=e.retrieveCanvas(),o=t.querySelector(".topleft"),a=t.querySelector(".topright"),i=t.querySelector(".bottomleft"),c=t.querySelector(".bottomright");if(e.readonly)l&&l.disable();else{var d=S._.create(n,{type:"x,y",edgeResistance:1,cursor:"move",activeCursor:"move",bounds:document.getElementById("vjs-annotation-bg"),onClick:function(){e.onSelect(e.md5)},onDrag:function(e){j.p8.to(o,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(a,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(i,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0}),j.p8.to(c,{x:j.p8.getProperty(n,"x"),y:j.p8.getProperty(n,"y"),duration:0})},onDragStart:function(t,n,o,a,i){var s=D(t,r);s.x,s.y;e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){var r=j.p8.getProperty(n,"x"),s=j.p8.getProperty(n,"y"),l=j.p8.getProperty(n,"rx"),u=j.p8.getProperty(n,"ry");"object"==A(l)&&(l=l.baseVal.value),"object"==A(u)&&(u=u.baseVal.value),"object"==A(r)&&(r=r.baseVal.value),"object"==A(s)&&(s=s.baseVal.value);var d={x:n.cx.baseVal.value+r-l-y,y:n.cy.baseVal.value+s-u-y,width:2*l+m,height:2*u+m};d.left=d.x,d.top=d.y,d.right=d.x+d.width,d.bottom=d.y+d.height,e.onDragEnd&&e.onDragEnd(t,e.md5,d),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0})}});u(d[0]);var f=-1,h=-1,p=!1,g=!1,v=!1,x=!1,b=null,w=null,P=S._.create(".drag-area-".concat(e.md5),{type:"x,y",edgeResistance:1,intertia:!1,bounds:document.getElementById("vjs-annotation-bg"),onDrag:function(e){if((p||g||v||x)&&b){var t=D(e,r),s=(t.x,t.y,{duration:0}),l={x:0,y:0,duration:0},u={x:0,y:0,duration:0},d={x:0,y:0,duration:0},m={x:0,y:0,duration:0};if(p&&(v?d.x=j.p8.getProperty(b,"x"):l.x=j.p8.getProperty(b,"x"),s.x=j.p8.getProperty(b,"x")/2,s.rx=f-j.p8.getProperty(b,"x")/2),g&&(v?m.x=j.p8.getProperty(b,"x"):u.x=j.p8.getProperty(b,"x"),s.x=j.p8.getProperty(b,"x")/2,s.rx=f+j.p8.getProperty(b,"x")/2),v&&(p?u.y=j.p8.getProperty(b,"y"):l.y=j.p8.getProperty(b,"y"),s.y=j.p8.getProperty(b,"y")/2,s.ry=h-j.p8.getProperty(b,"y")/2),x&&(p?m.y=j.p8.getProperty(b,"y"):d.y=j.p8.getProperty(b,"y"),s.y=j.p8.getProperty(b,"y")/2,s.ry=h+j.p8.getProperty(b,"y")/2),s.rx<=3||s.ry<=3)return null==w&&(w={x:0,y:0,duration:0},p&&v?(w.x=j.p8.getProperty(i,"x"),w.y=j.p8.getProperty(a,"y")):p&&x?(w.x=j.p8.getProperty(o,"x"),w.y=j.p8.getProperty(c,"y")):g&&v?(w.x=j.p8.getProperty(c,"x"),w.y=j.p8.getProperty(o,"y")):g&&x&&(w.x=j.p8.getProperty(a,"x"),w.y=j.p8.getProperty(i,"y"))),void j.p8.to(b,w);w=null,j.p8.to(n,s),o!=b&&j.p8.to(o,l),a!=b&&j.p8.to(a,u),i!=b&&j.p8.to(i,d),c!=b&&j.p8.to(c,m)}else P.forEach((function(e,t){e.endDrag()}))},onDragStart:function(t,r,o,a,i){b=t.target;var s=t.target.className;"object"==A(s)&&(s=s.baseVal),f=n.rx.animVal.value,h=n.ry.animVal.value,p=s.indexOf("left")>=0,g=s.indexOf("right")>=0,v=s.indexOf("top")>=0,x=s.indexOf("bottom")>=0,e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(r){f=h=-1,p=g=v=x=!1;var s={x:n.cx.baseVal.value+j.p8.getProperty(n,"x")-j.p8.getProperty(n,"rx")-y,y:n.cy.baseVal.value+j.p8.getProperty(n,"y")-j.p8.getProperty(n,"ry")-y,width:2*j.p8.getProperty(n,"rx")+m,height:2*j.p8.getProperty(n,"ry")+m};s.left=s.x,s.top=s.y,s.right=s.x+s.width,s.bottom=s.y+s.height,e.onDragEnd&&e.onDragEnd(r,e.md5,s,!0),j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0}),b=null}});j.p8.to(t,{x:0,y:0,duration:0}),j.p8.to(n,{x:0,y:0,duration:0}),j.p8.to(o,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),j.p8.to(c,{x:0,y:0,duration:0})}}}),[e.readonly,m]),b=function(){o(!0)},O=function(){o(!1)},k=function(e,t){h(t.format.color),y=t.format.weight/2,g(t.format.weight)},C=function(){var t=i.cloneNode(!0).querySelector(".video-ann-ellipse-bg");return t.setAttribute("cx",e.width/2),t.setAttribute("cy",e.height/2),t.setAttribute("style",""),t};(0,x.useImperativeHandle)(t,(function(){return{refreshUI:k,getSVGEle:function(){return i},outerHTML:C,show:b,hide:O}}));var I=6*e.scale;return I<m&&(I=m),(0,P.jsxs)("g",{className:w()("video-ann",e.md5,{show:r,readonly:e.readonly,selected:e.current==e.md5}),style:{opacity:e.selectedBlur?.1:1},ref:v,children:[(0,P.jsx)("ellipse",{className:w()("video-ann-ellipse-bg"),cx:e.x+e.width/2,cy:e.y+e.height/2,rx:e.width/2-y,ry:e.height/2-y,stroke:f,strokeWidth:m,style:{rx:e.width/2-y,ry:e.height/2-y,cx:e.x+e.width/2,cy:e.y+e.height/2},fill:"transparent"}),(0,P.jsx)("circle",{className:w()("select-circle topleft","drag-area-".concat(e.md5)),r:I,cx:e.x+y,cy:e.y+y}),(0,P.jsx)("circle",{className:w()("select-circle topright","drag-area-".concat(e.md5)),r:I,cx:e.x+e.width-y,cy:e.y+y}),(0,P.jsx)("circle",{className:w()("select-circle bottomright","drag-area-".concat(e.md5)),r:I,cx:e.x+e.width-y,cy:e.y+e.height-y}),(0,P.jsx)("circle",{className:w()("select-circle bottomleft","drag-area-".concat(e.md5)),r:I,cx:e.x+y,cy:e.y+e.height-y})]},e.md5)})),B=(0,x.forwardRef)((function(e,t){var n=E((0,x.useState)(e.show),2),r=n[0],o=n[1],a=E((0,x.useState)(null),2),i=a[0],s=a[1],c=E((0,x.useState)(null),2),l=c[0],u=c[1],d=E((0,x.useState)(e.format.color),2),f=d[0],h=d[1],p=E((0,x.useState)(e.format.weight),2),m=p[0],g=p[1],y=(0,x.useCallback)((function(t){null!==t&&(s(t),e.readonly?l&&l.disable():function(t,n){var r=t.querySelector(".video-ann-arrow-bg"),o=e.retrieveCanvas(),a=t.querySelector(".start"),i=t.querySelector(".end"),s=S._.create(r,{type:"x,y",edgeResistance:1,cursor:"move",activeCursor:"move",bounds:document.getElementById("vjs-annotation-bg"),onClick:function(){e.onSelect(e.md5)},onDrag:function(e){j.p8.to(a,{x:j.p8.getProperty(r,"x"),y:j.p8.getProperty(r,"y"),duration:0}),j.p8.to(i,{x:j.p8.getProperty(r,"x"),y:j.p8.getProperty(r,"y"),duration:0})},onDragStart:function(t,n,r,a,i){var s=D(t,o);s.x,s.y,e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){var n=j.p8.getProperty(r,"x"),o=j.p8.getProperty(r,"y");"object"==A(n)&&(n=n.baseVal.value),"object"==A(o)&&(o=o.baseVal.value);var s={left:r.x1.baseVal.value+n,top:r.y1.baseVal.value+o,right:r.x2.baseVal.value+n,bottom:r.y2.baseVal.value+o};e.onDragEnd&&e.onDragEnd(t,e.md5,s,!1),j.p8.to(r,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0})}});u(s[0]);var c=-1,l=-1,d=!1,f=!1,h=null,p=S._.create(".drag-area-".concat(e.md5),{type:"x,y",edgeResistance:1,intertia:!1,bounds:document.getElementById("vjs-annotation-bg"),onDrag:function(e){if((d||f)&&h){var t={duration:0};d?(t.x1=c+j.p8.getProperty(h,"x"),t.y1=l+j.p8.getProperty(h,"y")):f&&(t.x2=c+j.p8.getProperty(h,"x"),t.y2=l+j.p8.getProperty(h,"y")),j.p8.set(r,{attr:t})}else p.forEach((function(e,t){e.endDrag()}))},onDragStart:function(t,n,o,a,i){h=t.target;var s=t.target.className;"object"==A(s)&&(s=s.baseVal),d=s.indexOf("start")>=0,f=s.indexOf("end")>=0,d?(c=r.x1.baseVal.value,l=r.y1.baseVal.value):f&&(c=r.x2.baseVal.value,l=r.y2.baseVal.value),e.onDragStart&&e.onDragStart(t,e.md5)},onDragEnd:function(t){d=f;var n={left:r.x1.baseVal.value,top:r.y1.baseVal.value,right:r.x2.baseVal.value,bottom:r.y2.baseVal.value};e.onDragEnd&&e.onDragEnd(t,e.md5,n,!0),j.p8.to(r,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0}),h=null}});j.p8.to(r,{x:0,y:0,duration:0}),j.p8.to(a,{x:0,y:0,duration:0}),j.p8.to(i,{x:0,y:0,duration:0})}(t))}),[e.readonly,m]),v=function(){o(!0)},b=function(){o(!1)},O=function(e,t){h(t.format.color),g(t.format.weight)},k=function(e){var t=i.cloneNode(!0),n=t.querySelector(".start"),r=t.querySelector(".end");t.removeChild(n),t.removeChild(r);var o=t.querySelector(".video-ann-arrow-bg");o.setAttribute("x1",Math.abs(parseInt(o.getAttribute("x1"))-e.x)),o.setAttribute("y1",Math.abs(parseInt(o.getAttribute("y1"))-e.y)),o.setAttribute("x2",Math.abs(parseInt(o.getAttribute("x2"))-e.x)),o.setAttribute("y2",Math.abs(parseInt(o.getAttribute("y2"))-e.y)),o.setAttribute("style","");var a=document.createElementNS("http://www.w3.org/2000/svg","marker");a.setAttribute("markerWidth","10"),a.setAttribute("markerHeight","10"),a.setAttribute("id","arrow-"+f.substring(1)),a.setAttribute("refX","7"),a.setAttribute("refY","3"),a.setAttribute("orient","auto"),a.setAttribute("markerUnits","strokeWidth"),a.setAttribute("viewBox","0 0 10 10");var s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d","M0,0 L0,6 L9,3 z"),s.setAttribute("fill",f),a.appendChild(s),t.appendChild(a),t};(0,x.useImperativeHandle)(t,(function(){return{refreshUI:O,getSVGEle:function(){return i},outerHTML:k,show:v,hide:b}}));var C=6*e.scale;return C<1.6*m&&(C=1.6*m),(0,P.jsxs)("g",{className:w()("video-ann",e.md5,{show:r,readonly:e.readonly,selected:e.current==e.md5}),ref:y,style:{opacity:e.selectedBlur?.1:1},id:"svg-g-".concat(e.md5),children:[(0,P.jsx)("line",{className:w()("video-ann-arrow-bg"),x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,stroke:f,strokeWidth:m,markerEnd:"url(#arrow-".concat(f.substring(1),")")}),(0,P.jsx)("circle",{className:w()("select-circle start","drag-area-".concat(e.md5)),r:C,cx:e.left,cy:e.top}),(0,P.jsx)("circle",{className:w()("select-circle end","drag-area-".concat(e.md5)),r:C,cx:e.right,cy:e.bottom})]},e.md5)})),L=(n(4895),n(9676)),V=(n(47075),n(99177)),U=(n(69807),n(85986)),z=(n(37043),n(47933)),M=(n(84663),n(27049)),_=(n(13062),n(71230)),H=(n(38691),n(71577)),W=(n(89032),n(15746)),q=(n(6212),n(34041)),X=(n(45623),n(71257)),K=(n(87923),n(54680)),G=n(16165),Y=n(53607);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ne(e);if(t){var o=ne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){if(t&&("object"===J(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}var re=["rgb(255, 0, 0)","rgb(152, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(153, 153, 153)","rgb(183, 183, 183)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(239, 239, 239)","rgb(243, 243, 243)","rgb(255, 255, 255)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)","rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(133, 32, 12)","rgb(153, 0, 0)","rgb(180, 95, 6)","rgb(191, 144, 0)","rgb(56, 118, 29)","rgb(19, 79, 92)","rgb(17, 85, 204)","rgb(11, 83, 148)","rgb(53, 28, 117)","rgb(116, 27, 71)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],oe=["#373C44","#838383","#F6F6F6","#FF0200","#FF9900","#0172E6","#11DC00","#FF5A44","#BD8C00","#0013C5","#00CAB5","#930EBF"],ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(a,e);var t,n,r,o=ee(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t=o.call(this,e),"little"===e.type?t.state={width:98,colors:oe}:t.state={width:230,colors:re},t}return t=a,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.active,r=t.handleColorSelected,o=w()("editor-color-panel",{active:n}),a=function(e,t){r(e,t)};return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)("div",{className:o,style:{width:this.state.width},children:this.state.colors.map((function(t,n){return(0,P.jsx)("div",{className:"color-item","data-color":t,style:{backgroundColor:t,borderColor:(r=t,"rgb(239, 239, 239)"===r||"rgb(243, 243, 243)"===r||"rgb(255, 255, 255)"===r||"#F6F6F6"===r||"rgb(252, 229, 205)"===r||"rgb(255, 242, 204)"===r?"#bdc1c6":"transparent")},onClick:a.bind(e,t,n)},t);var r}))})})}}])&&$(t.prototype,n),r&&$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(x.PureComponent);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const le=function(e){return(0,P.jsxs)("svg",se(se({width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:[(0,P.jsxs)("g",{clipPath:"url(#video_editor_align_bottom_svg__a)",fill:"#fff",children:[(0,P.jsx)("rect",{x:11,y:10,width:2,height:10,rx:1,transform:"rotate(180 11 10)"}),(0,P.jsx)("rect",{x:20,y:17,width:20,height:4,rx:1,transform:"rotate(180 20 17)"})]}),(0,P.jsx)("defs",{children:(0,P.jsx)("clipPath",{id:"video_editor_align_bottom_svg__a",children:(0,P.jsx)("path",{fill:"#fff",transform:"rotate(180 10 10)",d:"M0 0h20v20H0z"})})})]}))};function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const he=function(e){return(0,P.jsxs)("svg",de(de({width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:[(0,P.jsx)("rect",{y:2,width:20,height:4,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{x:6,y:10,width:8,height:2,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{x:2,y:16,width:16,height:2,rx:1,fill:"#fff"})]}))};function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ye=function(e){return(0,P.jsxs)("svg",me(me({width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:[(0,P.jsx)("rect",{y:2,width:20,height:4,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{y:10,width:8,height:2,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{y:16,width:16,height:2,rx:1,fill:"#fff"})]}))};function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const we=function(e){return(0,P.jsxs)("svg",xe(xe({width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:[(0,P.jsx)("rect",{y:2,width:20,height:4,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{x:12,y:10,width:8,height:2,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{x:4,y:16,width:16,height:2,rx:1,fill:"#fff"})]}))};function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){Pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Oe=function(e){return(0,P.jsxs)("svg",Se(Se({width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:[(0,P.jsx)("rect",{x:9,y:10,width:2,height:10,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{y:3,width:20,height:4,rx:1,fill:"#fff"})]}))};function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ee=function(e){return(0,P.jsxs)("svg",Ce(Ce({width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:[(0,P.jsx)("rect",{x:9,width:2,height:5,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{x:9,y:15,width:2,height:5,rx:1,fill:"#fff"}),(0,P.jsx)("rect",{y:8,width:20,height:4,rx:1,fill:"#fff"})]}))};function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ne=function(e){return(0,P.jsx)("svg",De(De({width:"1em",height:"1em",viewBox:"0 0 12 16",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,P.jsx)("path",{d:"M0 16V0h6.24c1.08 0 1.92.12 2.64.36.72.242 1.32.723 1.8 1.324.48.602.72 1.564.72 2.406 0 .842-.24 1.684-.72 2.286a3.23 3.23 0 0 1-2.16 1.203c1.08.36 1.92.842 2.52 1.564.6.722.96 1.564.96 2.526 0 1.203-.36 2.286-1.2 3.128C9.96 15.639 8.76 16 7.08 16H0Zm2.76-9.263h3.48c.72 0 1.32-.24 1.68-.602.36-.36.6-.962.6-1.684s-.24-1.323-.72-1.684-.96-.481-1.56-.481H2.76v4.45Zm0 6.857h3.72c.84 0 1.44-.24 1.92-.602.48-.36.6-.962.6-1.684s-.24-1.203-.72-1.684c-.48-.481-1.08-.601-1.8-.601H2.76v4.571Z",fill:"#C8C8C8",fillRule:"nonzero"})}))};function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Be=function(e){return(0,P.jsx)("svg",Ze(Ze({width:"1em",height:"1em",viewBox:"0 0 11 16",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,P.jsx)("path",{d:"M8.25 1.333 5.5 14.667h2.75V16H0v-1.333h2.75L5.5 1.333H2.75V0H11v1.333z",fill:"#C8C8C8",fillRule:"nonzero"})}))};function Le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ue=K.Z.TreeNode,ze=v.Z.TextArea,Me=[24,36,48,64,80,112],_e=[2,4,6,8,10],He=["#FF0000","#FF9900","#0072E6","#12DC00","#E7E7E7","transparent","transparent","transparent","transparent","transparent"],We=["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#000000","#FF0000","#FF9900","#0072E6","#12DC00","#FFFFFF"],qe=(0,x.forwardRef)((function(e,t){var n=(0,x.createRef)(),r=(0,x.createRef)(),o=Le(X.Z.useForm(),1)[0],a=Le((0,x.useState)(e.italy),2),i=a[0],s=a[1],c=Le((0,x.useState)(e.bold),2),l=c[0],u=c[1],d=Le((0,x.useState)(e.color),2),h=d[0],p=d[1],m=Le((0,x.useState)(e.bgColor),2),g=m[0],y=m[1],b=Le((0,x.useState)(e.content),2),j=(b[0],b[1]),S=Le((0,x.useState)(e.link),2),O=(S[0],S[1]),k=Le((0,x.useState)({start:e.start,end:e.end}),2),C=k[0],A=k[1],E=Le((0,x.useState)(e.align),2),I=E[0],D=E[1],F=Le((0,x.useState)({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime}),2),N=F[0],T=F[1];(0,x.useEffect)((function(){o.setFieldsValue({link:e.link?e.link:"",content:e.content,size:e.size,start:e.start,end:e.end}),y(e.bgColor),O(e.link),p(e.color),s(e.italy),u(e.bold),j(e.content),D(e.align),T({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime}),A({start:e.start,end:e.end}),e.isLink&&o.validateFields(["link"]);var t=document.querySelector("#video-ann-text-input-start");t&&t.setAttribute("readonly",!0);var n=document.querySelector("#video-ann-text-input-end");n&&n.setAttribute("readonly",!0)}),[e.md5]);var Z=function(e){e?n&&n.current&&n.current.focus({cursor:"end"}):r&&r.current&&r.current.focus({cursor:"end"})},R=function(e,t,n,r,a){A({start:e,end:t}),o.setFieldsValue({size:n.size,content:r,link:a,start:e,end:t}),O(a),j(r),y(n.bgColor),p(n.color),s(n.italy),u(n.bold),D(n.align)},B=function(e,t){T({min:e,max:t})},L=function(){var t=!0;if(e.isLink){var n=o.getFieldError("link");if(!(t=!(n&&n.length>0))){var r=document.querySelector(".ant-form-item-explain-error");if(r){var a=r.className;r.className+=" video-ann-link-warn",setTimeout((function(){r.className=a}),500)}}}return t};(0,x.useImperativeHandle)(t,(function(){return{refreshUI:R,refreshRange:B,focus:Z,validate:L}}));var V=e.isLink||e.link&&e.link.length>0;return(0,P.jsxs)(X.Z,{className:"video-ann-property-form",form:o,initialValues:{link:e.link,size:e.size,content:e.content,start:C.start,end:C.end},layout:"vertical",children:[V?(0,P.jsx)(X.Z.Item,{name:"link",validateTrigger:["onChange","onBlur"],className:"video-ann-form-item",style:{marginBottom:"4px"},label:"URL",rules:[{required:!0,message:"You must input a URL starting with http or https in the link field."},{message:"Your URL must start with http:// or https://",pattern:/((https?|ftps?):\/\/)([-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*))/i}],children:(0,P.jsx)(v.Z,{className:"video-ann-property-textarea",tabIndex:5e3,onChange:function(t){o.setFieldsValue({link:t.target.value}),e.handleChangeLink(t.target.value)},ref:n,placeholder:"Insert a link"})}):"",(0,P.jsx)(X.Z.Item,{style:{marginBottom:"4px"},className:"video-ann-form-item",label:"Text",name:"content",children:(0,P.jsx)(ze,{placeholder:V?"Add link text":"Enter text here",id:"video-ann-".concat(V?"link-title":"text","-textarea"),className:"video-ann-property-textarea customized-scrollbar",onChange:function(t){e.handleChangeCt(t.target.value)},spellCheck:"false",tabIndex:5001,ref:r,autoSize:{minRows:1,maxRows:9}})}),(0,P.jsxs)(_.Z,{gutter:16,className:"video-ann-row",children:[(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{name:"size",className:"video-ann-form-item",style:{marginBottom:"16px"},label:"Text Format",children:(0,P.jsx)(q.Z,{className:"video-ann-property-select",dropdownClassName:"video-ann-property-dropdown",tabIndex:5002,onChange:function(t,n){var r=Math.floor(parseInt(n.key)/2);e.handleChangeFontSize(t,r)},children:Me.map((function(e,t){return(0,P.jsxs)(q.Z.Option,{className:"video-ann-property-option",value:e,children:[e,"px"]},t)}))})})}),(0,P.jsxs)(W.Z,{span:12,children:[(0,P.jsx)(H.Z,{className:w()("video-ann-property-bold txt-fmt-btn",{selected:l}),disabled:"transparent"==g&&We.indexOf(h)>=0,icon:(0,P.jsx)(G.Z,{component:Ne,style:{color:"white"}}),onClick:function(){e.handleChangeBold(!l),u(!l)},type:"text"}),(0,P.jsx)(H.Z,{className:w()("video-ann-property-italic txt-fmt-btn",{selected:i}),icon:(0,P.jsx)(G.Z,{component:Be,style:{color:"white"}}),onClick:function(){e.handleChangeItalic(!i),s(!i)},type:"text"})]})]}),(0,P.jsx)(M.Z,{orientation:"left",className:"video-ann-property-divider",plain:!0,children:"Align"}),(0,P.jsxs)(_.Z,{style:{marginBottom:"12px",marginTop:"8px"},className:"video-ann-row",gutter:4,children:[(0,P.jsx)(W.Z,{span:12,children:(0,P.jsxs)(z.ZP.Group,{defaultValue:I[0],className:"video-ann-align-group",optionType:"button",onChange:function(t){e.handleChangeAlign(t.target.value,I[1])},buttonStyle:"solid",children:[(0,P.jsx)(z.ZP.Button,{className:"video-ann-align-btn",value:"left",children:(0,P.jsx)(G.Z,{className:"video-ann-align-icon",component:ye,style:{color:"white"}})}),(0,P.jsx)(z.ZP.Button,{className:"video-ann-align-btn",value:"center",children:(0,P.jsx)(G.Z,{className:"video-ann-align-icon",component:he,style:{color:"white"}})}),(0,P.jsx)(z.ZP.Button,{className:"video-ann-align-btn",value:"right",children:(0,P.jsx)(G.Z,{className:"video-ann-align-icon",component:we,style:{color:"white"}})})]})}),(0,P.jsx)(W.Z,{span:12,children:(0,P.jsxs)(z.ZP.Group,{defaultValue:I[1],className:"video-ann-align-group",optionType:"button",onChange:function(t){e.handleChangeAlign(I[0],t.target.value)},buttonStyle:"solid",children:[(0,P.jsx)(z.ZP.Button,{className:"video-ann-align-btn",value:"top",children:(0,P.jsx)(G.Z,{className:"video-ann-align-icon",component:Oe,style:{color:"white"}})}),(0,P.jsx)(z.ZP.Button,{className:"video-ann-align-btn",value:"center",children:(0,P.jsx)(G.Z,{className:"video-ann-align-icon",component:Ee,style:{color:"white"}})}),(0,P.jsx)(z.ZP.Button,{className:"video-ann-align-btn",value:"bottom",children:(0,P.jsx)(G.Z,{className:"video-ann-align-icon",component:le,style:{color:"white"}})})]})})]}),(0,P.jsx)(M.Z,{orientation:"left",className:"video-ann-property-divider",plain:!0,children:"Color"}),(0,P.jsx)(_.Z,{style:{marginBottom:"12px",marginTop:"8px"},className:"video-ann-row",gutter:[12,10],children:He.map((function(t,n){var r=We[n];return(0,P.jsx)(W.Z,{className:"gutter-row",children:(0,P.jsx)(H.Z,{className:w()("video-ann-property-color txt-color-btn",{"is-Link":V}),style:{backgroundColor:n>=5?"#303030":t,WebkitTextStroke:n>=5?9==n?"1px #000000":"1px #ffffff":"none",fontWeight:n>=5?900:500,borderColor:g==t&&h==r?4==n?"black":"white":t,color:r},onClick:function(){e.handleChangeColor(t,r),p(r),y(t)},type:n>=5?"text":"primary",children:"T"})},n)}))}),(0,P.jsxs)(_.Z,{className:"video-ann-row",gutter:24,children:[(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{name:"start",className:"video-ann-form-item",label:"Start",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:N.min,max:C.end,step:.1,bordered:!0,id:"video-ann-text-input-start",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeStart})})}),(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{name:"end",className:"video-ann-form-item",label:"End",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:C.start+.1,max:N.max,id:"video-ann-text-input-end",bordered:!0,step:.1,formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeEnd})})})]})]})})),Xe=(0,x.forwardRef)((function(e,t){var n=Le((0,x.useState)({start:e.start,end:e.end}),2),o=n[0],a=n[1],i=Le((0,x.useState)({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime}),2),s=i[0],c=i[1];(0,x.useImperativeHandle)(t,(function(){return{refreshUI:u,refreshRange:d}}));var l=Le(X.Z.useForm(),1)[0];(0,x.useEffect)((function(){l.setFieldsValue({start:e.start,end:e.end}),a({start:e.start,end:e.end}),c({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime});var t=document.querySelector("#video-ann-cut-input-start");t&&t.setAttribute("readonly",!0);var n=document.querySelector("#video-ann-cut-input-end");n&&n.setAttribute("readonly",!0)}),[e.md5]);var u=function(e,t){a({start:e,end:t}),l.setFieldsValue({start:e,end:t})},d=function(e,t){c({min:e,max:t})};return(0,P.jsxs)(X.Z,{className:"video-ann-property-form",form:l,initialValues:{start:o.start,end:o.end},layout:"vertical",children:[(0,P.jsx)(r.Z.Title,{className:"video-ann-form-desc",level:5,children:"Remove part of the video"}),(0,P.jsxs)(_.Z,{className:"video-ann-row",gutter:24,children:[(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"start",label:"Start",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:s.min,max:o.end,step:.1,bordered:!0,id:"video-ann-cut-input-start",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeStart})})},0),(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"end",label:"End",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:o.start+.1,max:s.max,bordered:!0,step:.1,id:"video-ann-cut-input-end",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeEnd})})},1)]})]})})),Ke=(0,x.forwardRef)((function(e,t){var n=Le((0,x.useState)(e.blur),2),r=n[0],o=n[1],a=Le((0,x.useState)({start:e.start,end:e.end}),2),i=a[0],s=a[1],c=Le((0,x.useState)({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime}),2),l=c[0],u=c[1];(0,x.useImperativeHandle)(t,(function(){return{refreshUI:h,refreshRange:p}}));var d=Le(X.Z.useForm(),1)[0];(0,x.useEffect)((function(){d.setFieldsValue({start:e.start,end:e.end}),s({start:e.start,end:e.end}),o(e.blur),u({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime});var t=document.querySelector("#video-ann-blur-input-start");t&&t.setAttribute("readonly",!0);var n=document.querySelector("#video-ann-blur-input-end");n&&n.setAttribute("readonly",!0)}),[e.md5]);var h=function(t,n,r){s({start:t,end:n}),d.setFieldsValue({start:t,end:n}),o(e.blur)},p=function(e,t){u({min:e,max:t})};return(0,P.jsxs)(X.Z,{className:"video-ann-property-form",form:d,initialValues:{start:i.start,end:i.end},layout:"vertical",children:[m.Z.isSafari()?"":(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(M.Z,{orientation:"left",style:{marginTop:"4px"},className:"video-ann-property-divider",plain:!0,children:"Intensity"}),(0,P.jsxs)(_.Z,{className:"video-ann-row",gutter:24,style:{marginBottom:"6px",marginTop:"2px"},children:[(0,P.jsx)("span",{className:"video-ann-text",children:"Low"}),(0,P.jsx)(V.Z,{className:"video-ann-property-slider",min:2,max:20,step:2,tooltipVisible:!1,onChange:function(t){e.handleChangeBlur(t),o(t)},value:r}),(0,P.jsx)("span",{className:"video-ann-text",children:"High"})]})]}),(0,P.jsxs)(_.Z,{className:"video-ann-row",gutter:24,children:[(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"start",label:"Start",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:l.min,max:i.end,step:.1,bordered:!0,id:"video-ann-blur-input-start",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeStart})})},0),(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"end",label:"End",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:i.start+.1,max:l.max,bordered:!0,step:.1,id:"video-ann-blur-input-end",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeEnd})})},1)]})]})})),Ge=["#FF0000","#FF9900","#0072E6","#12DC00","#CF00FF","#FFFFFF"],Ye=(0,x.forwardRef)((function(e,t){var n=Le((0,x.useState)(e.alpha),2),r=n[0],o=n[1],a=Le((0,x.useState)(e.color),2),i=a[0],s=a[1],c=Le((0,x.useState)(e.border),2),l=c[0],u=c[1],d=Le((0,x.useState)(e.shadow),2),h=d[0],p=d[1],m=Le((0,x.useState)(e.border>0),2),g=m[0],y=m[1],v=Le((0,x.useState)(e.shadow>0),2),b=v[0],j=v[1],S=Le((0,x.useState)(!1),2),O=S[0],k=S[1],C=Le((0,x.useState)({start:e.start,end:e.end}),2),A=C[0],E=C[1],I=Le((0,x.useState)({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime}),2),D=I[0],F=I[1];(0,x.useImperativeHandle)(t,(function(){return{refreshUI:T,refreshRange:Z}}));var N=Le(X.Z.useForm(),1)[0];(0,x.useEffect)((function(){N.setFieldsValue({start:e.start,end:e.end}),E({start:e.start,end:e.end}),s(e.color),u(e.border),p(e.shadow),y(e.border>0),j(e.shadow>0),F({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime});var t=document.querySelector("#video-ann-image-input-start");t&&t.setAttribute("readonly",!0);var n=document.querySelector("#video-ann-image-input-end");n&&n.setAttribute("readonly",!0)}),[e.md5]);var T=function(e,t){E({start:e,end:t}),N.setFieldsValue({start:e,end:t})},Z=function(e,t){F({min:e,max:t})};return(0,P.jsxs)(X.Z,{className:"video-ann-property-form",form:N,initialValues:{start:A.start,end:A.end},layout:"vertical",children:[(0,P.jsx)(M.Z,{orientation:"left",style:{marginTop:6},className:"video-ann-property-divider",plain:!0,children:(0,P.jsx)(L.Z,{className:"video-ann-property-checkbox",checked:g,onChange:function(t){y(t.target.checked),t.target.checked?_e.includes(l)?e.handleChangeBorder(l):(u(4),e.handleChangeBorder(4)):e.handleChangeBorder(0)},children:"Border"})}),g?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(M.Z,{orientation:"left",className:"video-ann-property-divider",style:{marginTop:14},plain:!0,children:"Color"}),(0,P.jsx)(_.Z,{style:{marginBottom:"8px",marginTop:"8px"},gutter:11,children:(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(Y.PU,{className:w()("tool-color-picker multi-btn",{selected:O}),onPopupShown:function(e){k(e)},children:function(t,n){return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:"tool-current-color current",id:"tool-current-color",style:{backgroundColor:i},"data-color":i}),(0,P.jsx)("span",{className:"ant-select-arrow",unselectable:"on","aria-hidden":"true",style:{marginLeft:8,userSelect:"none"},children:(0,P.jsx)("span",{role:"img","aria-label":"down",className:"anticon anticon-down ant-select-suffix",children:(0,P.jsx)("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"down",width:"1em",height:"1em",fill:"white","aria-hidden":"true",children:(0,P.jsx)("path",{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"})})})}),(0,P.jsx)(ae,{active:t.isExpand,type:"little",handleColorSelected:function(t){n(),e.handleChangeColor(t),s(t)}})]})}})})}),(0,P.jsx)(M.Z,{orientation:"left",className:"video-ann-property-divider",plain:!0,children:"Size"}),(0,P.jsx)(K.Z,{style:{width:"100%",height:"30px",marginBottom:"2px",marginTop:"8px"},value:l>0?l:void 0,className:"video-ann-property-select",dropdownClassName:"video-ann-property-dropdown",placeholder:"Please select",treeDefaultExpandAll:!0,onChange:function(t){e.handleChangeBorder(t),u(t)},children:_e.map((function(e){return(0,P.jsx)(Ue,{className:"video-ann-property-node",value:e,title:(0,P.jsx)("div",{className:"video-ann-property-line",style:{height:e+"px",marginTop:(28-e)/2+"px"}})},e)}))})]}):"",(0,P.jsx)(M.Z,{className:"video-ann-property-divider-sep"}),(0,P.jsx)(M.Z,{orientation:"left",className:"video-ann-property-divider",plain:!0,children:(0,P.jsx)(L.Z,{className:"video-ann-property-checkbox",checked:b,onChange:function(t){j(t.target.checked),t.target.checked?e.handleChangeShadow(h):e.handleChangeShadow(0)},children:"Shadow"})}),b?(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)(_.Z,{className:"video-ann-row",gutter:24,style:{marginBottom:"0",marginTop:"2px"},children:[(0,P.jsx)("span",{className:"video-ann-text",children:"Light"}),(0,P.jsx)(V.Z,{className:"video-ann-property-slider",min:0,max:3,step:1,tooltipVisible:!1,onChange:function(t){e.handleChangeShadow(t),p(t)},value:h}),(0,P.jsx)("span",{className:"video-ann-text",children:"Heavy"})]})}):"",(0,P.jsx)(M.Z,{className:"video-ann-property-divider-sep",style:{marginTop:b?8:14}}),(0,P.jsx)(M.Z,{orientation:"left",style:{marginTop:"4px"},className:"video-ann-property-divider",plain:!0,children:"Opacity"}),(0,P.jsxs)(_.Z,{className:"video-ann-row",gutter:24,style:{marginBottom:"6px",marginTop:"2px"},children:[(0,P.jsx)("span",{className:"video-ann-text",children:"Low"}),(0,P.jsx)(V.Z,{className:"video-ann-property-slider",min:.1,max:1,step:.1,tooltipVisible:!1,onChange:function(t){e.handleChangeAlpha(t),o(t)},value:r}),(0,P.jsx)("span",{className:"video-ann-text",children:"High"})]}),(0,P.jsxs)(_.Z,{className:"video-ann-row",gutter:24,children:[(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"start",label:"Start",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:D.min,max:A.end,step:.1,bordered:!0,id:"video-ann-image-input-start",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeStart})})},0),(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"end",label:"End",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:A.start+.1,max:D.max,bordered:!0,step:.1,id:"video-ann-image-input-end",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeEnd})})},1)]})]})})),Je=(0,x.forwardRef)((function(e,t){var n=Le(X.Z.useForm(),1)[0],r=Le((0,x.useState)(e.color),2),o=r[0],a=r[1],i=Le((0,x.useState)(e.weight),2),s=i[0],c=i[1],l=Le((0,x.useState)({start:e.start,end:e.end}),2),u=l[0],d=l[1],h=Le((0,x.useState)({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime}),2),p=h[0],m=h[1];(0,x.useEffect)((function(){n.setFieldsValue({start:e.start,end:e.end}),a(e.color),c(e.weight),d({start:e.start,end:e.end}),m({min:e.timeRangeBySec?e.timeRangeBySec.min:0,max:e.timeRangeBySec?e.timeRangeBySec.max:e.maxTime});var t=document.querySelector("#video-ann-shape-input-start");t&&t.setAttribute("readonly",!0);var r=document.querySelector("#video-ann-shape-input-end");r&&r.setAttribute("readonly",!0)}),[e.md5]);var g=function(e,t){m({min:e,max:t})},y=function(e,t,r){d({start:e,end:t}),n.setFieldsValue({start:e,end:t}),a(r.color),c(r.weight)};return(0,x.useImperativeHandle)(t,(function(){return{refreshRange:g,refreshUI:y}})),(0,P.jsxs)(X.Z,{className:"video-ann-property-form",initialValues:{start:u.start,end:u.end},form:n,layout:"vertical",children:[(0,P.jsx)(M.Z,{orientation:"left",className:"video-ann-property-divider",plain:!0,children:"Size"}),(0,P.jsx)(K.Z,{style:{width:"100%",height:"30px",marginBottom:"16px",marginTop:"8px"},value:s,tabIndex:5001,className:"video-ann-property-select",dropdownClassName:"video-ann-property-dropdown",placeholder:"Please select",treeDefaultExpandAll:!0,onChange:function(t){e.handleChangeWeight(t)},children:[2,4,6,8,12].map((function(e){return(0,P.jsx)(Ue,{className:"video-ann-property-node",value:e,title:(0,P.jsx)("div",{className:"video-ann-property-line",style:{height:e+"px",marginTop:(28-e)/2+"px"}})},e)}))}),(0,P.jsx)(M.Z,{orientation:"left",className:"video-ann-property-divider",plain:!0,children:"Color"}),(0,P.jsx)(_.Z,{style:{marginBottom:"12px",marginTop:"8px"},gutter:11,children:Ge.map((function(t,n){return(0,P.jsx)(W.Z,{className:"gutter-row",span:4,children:(0,P.jsx)(H.Z,{className:"video-ann-property-color shape-color-btn",style:{backgroundColor:t,borderColor:o==t?"white":t},onClick:function(){e.handleChangeColor(t),a(t)},type:"primary"})},t+n)}))}),(0,P.jsxs)(_.Z,{gutter:24,children:[(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"start",label:"Start",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:p.min,max:u.end,step:.1,bordered:!0,id:"video-ann-shape-input-start",formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeStart})})},0),(0,P.jsx)(W.Z,{span:12,children:(0,P.jsx)(X.Z.Item,{className:"video-ann-form-item",name:"end",label:"End",children:(0,P.jsx)(U.Z,{className:"video-ann-property-input",min:u.start+.1,max:p.max,id:"video-ann-shape-input-end",bordered:!0,step:.1,formatter:function(e){return(0,f.ZX)(e)},parser:function(e){return(0,f.sZ)(e)},onChange:e.onChangeEnd})})},1)]})]})})),$e=n(34102),Qe=n(61579),et=n(41374),tt=n(92011),nt=n(59413),rt=n(15191),ot=n(85530);function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){st(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ct=function(e){return(0,P.jsx)("svg",it(it({width:"1em",height:"1em",viewBox:"0 0 12 12",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,P.jsx)("path",{d:"M10.5.5c.828 0 1.5.657 1.5 1.467v8.066c0 .81-.672 1.467-1.5 1.467h-9c-.828 0-1.5-.657-1.5-1.467V1.967C0 1.157.672.5 1.5.5h9ZM8.204 6.674 6.216 9.037l-.069.068a.915.915 0 0 1-1.201.01l-.07-.068L3.372 7.43 1.125 9.585v.448c0 .18.133.33.308.361l.067.006h9c.184 0 .337-.13.369-.3l.006-.067v-.93l-2.671-2.43ZM10.5 1.6h-9a.373.373 0 0 0-.369.3l-.006.067v6.18L2.748 6.59a.915.915 0 0 1 1.2-.053l.096.09 1.493 1.602 1.957-2.327a.914.914 0 0 1 1.187-.178l.08.057.04.035 2.074 1.885V1.967a.37.37 0 0 0-.308-.361L10.5 1.6Z",fill:"#currentColor",fillRule:"nonzero"})}))};function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ht(e,t)}function ht(e,t){return ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ht(e,t)}function pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yt(e);if(t){var o=yt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mt(this,n)}}function mt(e,t){if(t&&("object"===vt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gt(e)}function gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yt(e){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yt(e)}function vt(e){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(e)}function xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e,t,n){return t&&bt(e.prototype,t),n&&bt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return St(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pt="#FF0000",Ot=window.devicePixelRatio>1?48:36,kt=window.devicePixelRatio>1?64:48,Ct=280,At=160,Et=function(e){var t=1;if(e&&e.videoDuration>0){var n=s.ZP.round(50*e.videoDuration/e.processbarLength,4);n>1&&(t=n)}return t},It=null,Dt=function(e,t){It||(It=document.createElement("canvas"));var n=It.getContext("2d");return n.font=t,n.measureText(e)},Ft={bold:!1,italy:!1,fontFamily:"'Open Sans', 'Noto Sans', sans-serif",size:Ot,color:"#FFFFFF",bgColor:Pt,align:["center","center"],isBg:!1},Nt={weight:6,rotate:0,color:Pt},Tt={alpha:1,rotate:0,shadow:1,border:0,color:Pt},Zt={start:0,duration:0,format:Nt,screenPos:{width:0,height:0},left:0,top:0,right:0,bottom:0},Rt={content:"",start:0,format:Ft,screenPos:{width:0,height:0},duration:0,left:0,top:0,link:""},Bt={start:0,duration:0},Lt=function(){function e(t,n,r,o){var a=this;xt(this,e),this.onReferBar=function(e){a.referBarItem=e},this.info=(0,f.zs)(e.typeDef(n)),this.md5=this.info.md5||(0,f.D_)(),this.hash=(0,f.OT)(this.info),this.options=o,(!this.info.type||this.info.type.length<=0)&&(this.info.type=r),this.env=t,this.refreshSidebar=!1,this.refreshProcessBar=!1,this.refreshSimulator=!1,this._timeRangeBySec=null,this.referForm=(0,x.createRef)(),this.referSimulatorItem=(0,x.createRef)(),this.referBarItem=(0,x.createRef)()}return wt(e,[{key:"duration",get:function(){return this.info.duration},set:function(e){this.info.duration=s.ZP.round(e,1)}},{key:"sortStart",get:function(){return this.start}},{key:"start",get:function(){return this.info.start},set:function(e){this.info.start=s.ZP.round(e,1)}},{key:"timeRangeBySec",get:function(){return this._timeRangeBySec},set:function(e){this._timeRangeBySec=(0,f.zs)(e),this.referForm&&this.referForm.current&&this.referForm.current.refreshRange&&this.referForm.current.refreshRange(e.min,e.max)}},{key:"end",get:function(){return s.ZP.plus(this.info.start,this.info.duration)}},{key:"type",get:function(){return this.info.type},set:function(e){this.info.type=e,this.hash=(0,f.OT)(this.info)}},{key:"getJSONInfo",value:function(){return JSON.stringify(this.info)}},{key:"refreshUI",value:function(){}},{key:"checkFormValidate",value:function(){return!(this.referForm&&this.referForm.current&&this.referForm.current.validate)||this.referForm.current.validate()}},{key:"onChangeStart",value:function(e){var t=this.end-e;this.options.onUpdate(this.md5,{start:e,duration:s.ZP.round(t,1)})}},{key:"onChangeEnd",value:function(e){this.start;this.options.onUpdate(this.md5,{duration:s.ZP.round(e-this.start,1)})}},{key:"unmount",value:function(){this.referBarItem&&this.referBarItem.current&&this.referBarItem.current.unmount&&this.referBarItem.current.unmount()}},{key:"focus",value:function(){}},{key:"updateInfo",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];if("object"==vt(n))if("format"==t){for(var r in this.info.format||(this.info.format={}),n)this.info.format[r]=n[r];this.refreshSidebar=!0,this.refreshSimulator=!0}else"screenPos"==t&&m.Z.isSafari()?(this.info[t]=(0,f.zs)(n),this.refreshSimulator=!0):this.info[t]=(0,f.zs)(n);else"duration"==t&&n>0||"start"==t&&n>=0?(this.refreshSidebar=!0,this.refreshProcessBar=!0):"content"==t?this.refreshSimulator=!0:"left"!=t&&"top"!=t&&"width"!=t&&"height"!=t||(this.refreshSimulator=!0),this.info[t]=n}this.hash=(0,f.OT)(this.info),this.refreshUI()}},{key:"clone",value:function(){return new e(this.env,this.info,this.type)}}],[{key:"typeDef",value:function(e){if(!e)return{};var t=e.start,n=e.duration;return"string"==typeof t&&(e.start=s.ZP.round(parseFloat(t),1)),"string"==typeof n&&(e.duration=s.ZP.round(parseFloat(n),1)),e}}]),e}(),Vt=function(e){ft(n,e);var t=pt(n);function n(e,r,o,a){var i;return xt(this,n),(i=t.call(this,e,n.typeDef(r),o,a)).canBeShown=function(e){return i.start<=e&&i.end>=e},i.repaint=function(e,t){var n=function(){if("arrow"==i.info.cmd||"link"==i.type||"text"==i.type){var e={};e="arrow"==i.info.cmd?i.calculateActualPos(p()(i.info,["left","top","right","bottom"])):i.calculateActualPos(p()(i.info,["x","y","width","height"])),i.info.width=e.width,i.info.height=e.height,i.info.x=e.x,i.info.y=e.y}};i.referSimulatorItem&&i.referSimulatorItem.current?i.canBeShown(e)||t?(i.referSimulatorItem.current.show(),setTimeout(n,100)):i.referSimulatorItem.current.hide():t&&setTimeout((function(){i.referSimulatorItem&&i.referSimulatorItem.current&&(i.referSimulatorItem.current.show(),setTimeout(n,100))}),200)},i.prepareUploadSnapshot=function(e){var t=gt(i);return new Promise((function(n,r){t._snapshotKey=(0,f.D_)();var o=t.size,a=(0,f.zs)(o);if(a.x=0,a.y=0,t.info.snapshotType="image/png","arrow"==t.info.cmd){o.x=t.info.x,o.y=t.info.y;var i=1.6*t.info.format.weight,s=Math.abs(t.info.top-t.info.bottom),c=Math.abs(t.info.right-t.info.left),l=Math.hypot(1,3)*t.info.format.weight*3,u=Math.hypot(s,c),d=s/c,h=Math.atan(1/3),p=2*t.info.format.weight*s/u+i,m=i,g=2*t.info.format.weight*c/u+i,y=i,v=i+g,x=i+p;if(d>3)if(o.width<l)o.x-=g+(l-o.width)/2,t.info.x=o.x,a.width=l+v,a.height+=x,t.info.top>t.info.bottom?o.y-=p:o.y-=i,t.info.y=o.y;else{var b=Math.atan(1/d),w=l*Math.sin(h-b);t.info.right<t.info.left?o.x-=w+y:o.x-=g,t.info.x=o.x,a.width+=w+v,a.height+=x,t.info.top>t.info.bottom?o.y-=p:o.y-=i,t.info.y=o.y}else if(d<.3333)if(o.height<l)o.y-=p+(l-o.height)/2,t.info.y=o.y,a.height=l+x,a.width+=v,t.info.right<t.info.left?o.x-=g:o.x-=i,t.info.x=o.x;else{var j=Math.atan(d),S=l*Math.sin(h-j);t.info.top>t.info.bottom?o.y-=S+p:o.y-=S+m,t.info.y=o.y,a.height+=S+x,a.width+=v,t.info.right<t.info.left?o.x-=g:o.x-=i,t.info.x=o.x}else a.height+=x,a.width+=v,t.info.top>t.info.bottom?o.y-=p:o.y-=i,t.info.right<t.info.left?o.x-=g:o.x-=i,t.info.y=o.y,t.info.x=o.x}else"text"!=t.type&&"link"!=t.type||"transparent"!=t.info.format.bgColor&&(a.x=-10,a.y=-10,a.width+=20,a.height+=20,t.info.y=t.info.top-10,t.info.x=t.info.left-10);(0,f.zB)(t.referSimulatorItem.current.outerHTML(o),a,t.assistIndex,e,t.info.snapshotType,(function(e){t._localFile=new File([e],t.snapshotKey+".png"),n(t)}))}))},i.dataforUpload=function(){for(var e in i.info)if(i.info.hasOwnProperty(e)){var t=i.info[e];Number(t)===t&&t%1!=0&&(i.info[e]=s.ZP.round(t,1))}return ut(ut({},i.info),{},{md5:i.md5})},i.codeForBar=function(){},i.displayWidth=0,i.displayHeight=0,i._formatChanged=!1,i._localFile=null,i._snapshotKey=null,i.uploadFailed=!1,i}return wt(n,[{key:"formatChanged",get:function(){return this._formatChanged},set:function(e){this._formatChanged=e}},{key:"focus",value:function(){this.info.zIndex=(new Date).getTime()}},{key:"zIndex",get:function(){return"blur"==this.info.type?this.info.zIndex-1e10:this.info.zIndex}},{key:"color",get:function(){return this.info.format.bgColor||"text"!=this.type&&"link"!=this.type?this.info.format.color:"white"}},{key:"borderColor",get:function(){var e="rgba(231, 231, 231,0.4)";switch(this.info.format.bgColor){case"#FF0000":case"#CF00FF":e="rgba(255,255,255,0.4)";break;case"#FF9900":e="rgba(255,255,255,0.38)";break;case"#0072E6":e="rgba(255,255,255,0.2)";break;case"#12DC00":e="rgba(255,255,255,0.5)";break;case"#E7E7E7":e="rgba(255,255,255,1)"}return e}},{key:"assistIndex",get:function(){return-1}},{key:"snapshotKey",get:function(){return this._snapshotKey&&this._snapshotKey.length>0?this._snapshotKey:this.info.snapshotKey},set:function(e){this._snapshotKey=e}},{key:"snapshotType",get:function(){return this.info.snapshotType}},{key:"localSnapshotFile",get:function(){return this._localFile},set:function(e){this._localFile=e}},{key:"shouldbeUpload",value:function(){return!1}},{key:"updateSnapshotKey",value:function(){this._snapshotKey&&this._snapshotKey.length>0&&this._snapshotKey!=this.info.snapshotKey&&(this.info.snapshotKey=this._snapshotKey)}},{key:"refreshInfo",value:function(){return ut(ut({},this.info),{},{isLittleScreenMode:this.env.isLittleScreenMode})}},{key:"shouldUpdateImage",value:function(){return this.formatChanged||!this.info.snapshotKey||this.info.snapshotKey.length<=0}},{key:"calculateActualPos",value:function(){return Object.assign(this.size,p()(this.info,["x","y"]))}}],[{key:"typeDef",value:function(e){if(!e)return{};var t=e.zIndex,n=e.x,r=e.y,o=e.left,a=e.top;return"string"==typeof o&&(e.left=parseFloat(o)),"string"==typeof a&&(e.top=parseFloat(a)),void 0===n&&(e.x=e.left),void 0===r&&(e.y=e.top),void 0===t&&(e.zIndex=0),e}}]),n}(Lt),Ut=[3,4,8],zt=[1,2,4],Mt=[2,4,6],_t=[4,8,16],Ht=function(e){ft(n,e);var t=pt(n);function n(e,r,o,a){var i;xt(this,n),(i=t.call(this,e,n.typeDef(r),o,a)).calculatePosition=function(e){return e&&(i.info.left=(e.width-i.displayWidth)/2,i.info.top=(e.height-i.displayHeight)/2,!i.info.scale&&i.info.screenPos&&(i.info.scale=e.width/i.info.screenPos.width),i.info.x=i.info.left-10,i.info.y=i.info.top-10,i.info.range={width:e.width,height:e.height}),gt(i)},i.handleChangeFontSize=function(e,t){i.formatChanged=!0,i.options.onUpdate(i.md5,{format:{size:e,borderWidth:Ut[t],strokeWidth:zt[t],borderRadius:_t[t],assistIndex:t,underlineWidth:Mt[t],paddingX:s.ZP.round(2*e/3,1)}})},i.handleChangeItalic=function(e){i.formatChanged=!0,i.options.onUpdate(i.md5,{format:{italy:e}})},i.handleChangeAlign=function(e,t){i.formatChanged=!0,i.options.onUpdate(i.md5,{format:{align:[e,t]}})},i.handleChangeBold=function(e){i.formatChanged=!0,i.options.onUpdate(i.md5,{format:{bold:e}})},i.handleChangeColor=function(e,t){i.formatChanged=!0,i.refreshProcessBar=!0,i.options.onUpdate(i.md5,{format:{color:t,bgColor:e}})},i.handleChangeCt=function(e){i.formatChanged=!0,i.refreshProcessBar=!0,i.refreshSidebar=!0,i.options.onUpdate(i.md5,{content:e})},i.handleChangeLink=function(e){i.formatChanged=!0,i.refreshProcessBar=!0,i.refreshSidebar=!0;var t={link:e};t.content=e,i.options.onUpdate(i.md5,t)},i.canReset=function(){return i.formatChanged},i.reset=function(e){i.options.onUpdate(i.md5,{content:"",format:Ft})},i.code4Property=function(e){return(0,P.jsx)(qe,ut(ut({start:i.start,end:i.end,ref:i.referForm,md5:i.md5,content:i.info.content,isLink:"link"==i.type},i.info.format),{},{link:i.info.link||i.info.format.link,timeRangeBySec:i.timeRangeBySec,maxTime:e,isLittleMode:i.env.isLittleScreenMode,handleChangeLink:function(e){i.formatChanged=!0,i.refreshProcessBar=!0,i.refreshSidebar=!0;var t={};null!=e.match(/((https?|ftps?):\/\/)([-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*))/i)?(t.link=e,(!i.info.content||i.info.content.length<=0)&&(t.content=e)):t.link=e,i.options.onUpdate(i.md5,t)},handleChangeCt:i.handleChangeCt,handleChangeFontSize:i.handleChangeFontSize,handleChangeItalic:i.handleChangeItalic,handleChangeBold:i.handleChangeBold,handleChangeColor:i.handleChangeColor,handleChangeAlign:i.handleChangeAlign,onChangeEnd:function(e){i.onChangeEnd(e)},onChangeStart:function(e){i.onChangeStart(e)}}))},i.ctInBar=function(){return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(G.Z,{className:"ct-symbol",style:{color:i.color},component:i.isLink?Qe.Z:et.Z}),(0,P.jsx)("span",{id:"txt-ct-".concat(i.md5),className:"ct-txt",style:{textTecoration:i.isLink?"underline":""},children:i.info.content})]})},i.code4Paint=function(e,t){return(0,P.jsx)(F,ut(ut({width:i.displayWidth,height:i.displayHeight,minSize:i.minSize,readonly:e||null!=document.fullscreenElement,scale:t.scale,selectedBlur:t.selectedBlur,show:i.canBeShown(t.currentTime),ref:i.referSimulatorItem,current:t.selectedMd5,retrieveCanvas:t.retrieveCanvas,txtDispOffsetX:i.paddingX,txtDispOffsetY:4+1.05*i.info.format.size,md5:i.md5,handleChangeCt:function(e){i.isLink?null!=e.match(/((https?|ftps?):\/\/)([-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*))/i)?i.handleChangeLink(e):i.handleChangeCt(e):i.handleChangeCt(e)},onSelect:t.onSelect,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd},i.info),{},{borderWidth:i.borderWidth,strokeWidth:i.strokeWidth,assistIndex:i.assistIndex,borderRadius:i.borderRadius,underlineWidth:i.underlineWidth,isLittleMode:i.env.isLittleScreenMode,isLink:i.isLink}),i.md5)},i.minSize={};var c=i.size;return i.displayWidth=c.width,i.displayHeight=c.height,i}return wt(n,[{key:"bgColor",get:function(){return this.info.format?!this.info.format.bgColor&&this.info.format.color?this.info.format.color:"transparent"!=this.info.format.bgColor&&this.info.format.bgColor?this.info.format.bgColor:"#000000":"#FFFFFF"}},{key:"size",get:function(){var e=function(e,t){if(!e)return{};var n,r="".concat(t.italy?"italic":"normal"," ").concat(t.bold||!t.bgColor||"transparent"==t.bgColor?"900":"normal"," ").concat(t.size,"px ").concat(t.fontFamily),o=e.split("\n"),a=0,i=jt(o);try{for(i.s();!(n=i.n()).done;){var s=n.value,c=Dt(s,r).width;c>a&&(a=c)}}catch(e){i.e(e)}finally{i.f()}return{width:a+6,height:o.length*t.size*1.5+o.length-1}}(this.info.content&&this.info.content.length>0?this.info.content:this.isLink?"Add link text":"Enter text here",this.info.format);return this.minSize={width:e.width+2*this.paddingX,height:e.height+8},this.info.width&&this.info.height?{width:this.info.width,height:this.info.height}:this.minSize}},{key:"strokeWidth",get:function(){return this.info.format.strokeWidth?this.info.format.strokeWidth:zt[this.assistIndex]}},{key:"borderWidth",get:function(){return this.info.format.borderWidth?this.info.format.borderWidth:Ut[this.assistIndex]}},{key:"underlineWidth",get:function(){return this.info.format.underlineWidth?this.info.format.underlineWidth:Mt[this.assistIndex]}},{key:"borderRadius",get:function(){return this.info.format.borderRadius?this.info.format.borderRadius:_t[this.assistIndex]}},{key:"assistIndex",get:function(){return this.info.format.assistIndex||0==this.info.format.assistIndex||(this.info.format.assistIndex=this.env.isLittleScreenMode?1:0),this.info.format.assistIndex}},{key:"paddingX",get:function(){return this.info.format.paddingX||(this.info.format.paddingX=s.ZP.round(2*this.info.format.size/3,1)),this.info.format.paddingX}},{key:"isLink",get:function(){return!!(this.info&&(this.info.link&&this.info.link.length>0||this.info.format.link&&this.info.format.link.length>0)||"link"==this.type)}},{key:"shouldbeUpload",value:function(){return this.info.content&&this.info.content.length>0&&(this.isLink&&this.info.link&&this.info.link.length>0||!this.isLink)}},{key:"refreshUI",value:function(){var e=this.size;this.info.width=e.width<this.minSize.width?this.minSize.width:e.width,this.info.height=e.height<this.minSize.height?this.minSize.height:e.height,this.info.left+this.info.width>this.info.range.width&&(this.info.left=this.info.range.width-this.info.width),this.info.top+this.info.height>this.info.range.height&&(this.info.top=this.info.range.height-this.info.height);var t=6*this.env.scale;this.info.left<t&&(this.info.left=t),this.info.top<t&&(this.info.top=t),this.info.width>=this.info.range.width-2*t&&(this.info.width=this.info.range.width-2*t),this.info.height>=this.info.range.height-2*t&&(this.info.height=this.info.range.height-2*t),this.info.y=this.info.top-10,this.info.x=this.info.left-10,this.referSimulatorItem&&this.referSimulatorItem.current&&this.refreshSimulator&&this.referSimulatorItem.current.refreshUI(this.env.scale,{width:this.info.width,height:this.info.height},this.info);var n=document.querySelector("#txt-ct-".concat(this.md5));n&&(n.innerText=this.info.content),this.referForm&&this.referForm.current&&this.refreshSidebar&&this.referForm.current.refreshUI(this.start,this.end,this.info.format,this.info.content,this.info.link)}},{key:"focus",value:function(){this.isLink&&this.info.content.length>0&&this.info.link.length>0||!this.isLink&&this.info.content.length>0||(this.isLink&&this.info.content.length>0||this.env.isLittleScreenMode?this.referForm&&this.referForm.current&&this.referForm.current.focus(this.isLink&&this.info.content.length>0):this.referSimulatorItem&&this.referSimulatorItem.current&&this.referSimulatorItem.current.focus())}}],[{key:"typeDef",value:function(e){if(!e)return{};var t=e.screenPos,n=e.x,r=e.y,o=e.format,a=e.left,i=e.top;return t&&("string"==typeof t.width&&(t.width=parseFloat(t.width)),"string"==typeof t.height&&(t.height=parseFloat(t.height))),o?"object"!=vt(o.align)&&(o.align=["center","center"]):e.format=(0,f.zs)(Ft),n!=s.ZP.minus(a,10)&&(e.left=n),r!=s.ZP.minus(i,10)&&(e.top=r),e}},{key:"Create",value:function(e,t,r,o,a){var i=(0,f.zs)(Rt);return i.md5=t,i.start=s.ZP.round(e,1),i.start>e&&(i.start-=.1),i.duration=Et(o),i.start+i.duration>o.videoDuration&&(i.start=o.videoDuration-i.duration),i.format=(0,f.zs)(Ft),o.isLittleScreenMode&&(i.format.size=kt),i.screenPos=(0,f.zs)(o.screenPos),i.scale=o.scale,i.zIndex=(new Date).getTime(),new n(o,i,r,a).calculatePosition(o.videoBound)}}]),n}(Vt),Wt=function(e){ft(n,e);var t=pt(n);function n(e,r,o){var a;xt(this,n),(a=t.call(this,e,n.typeDef(r),"shape",o)).calculatePosition=function(e){return e&&(a.info.x=(e.width-Ct)/2,a.info.y=(e.height-At)/2,!a.info.scale&&a.info.screenPos&&(a.info.scale=e.width/a.info.screenPos.width),a.info.left=a.info.x,a.info.top=a.info.y,a.info.right=a.info.x+Ct,a.info.bottom=a.info.y+At,a.info.width=Ct,a.info.height=At,a.info.range={width:e.width,height:e.height}),gt(a)},a.ctInBar=function(){var e="#FFFFFF"==a.info.format.color?"#000000":"#FFFFFF";return"rect"==a.info.cmd?(0,P.jsx)(G.Z,{className:"ct-symbol",style:{color:e},component:tt.Z}):"ellipse"==a.info.cmd?(0,P.jsx)(G.Z,{className:"ct-symbol",style:{color:e},component:rt.Z}):(0,P.jsx)(G.Z,{className:"ct-symbol",style:{color:e},component:nt.Z})},a.code4Paint=function(e,t){var n={width:a.info.width,height:a.info.height,key:a.md5,readonly:e||null!=document.fullscreenElement,show:a.canBeShown(t.currentTime),ref:a.referSimulatorItem,current:t.selectedMd5,selectedBlur:t.selectedBlur,md5:a.md5,scale:t.scale,retrieveCanvas:t.retrieveCanvas,onSelect:t.onSelect,onDragStart:t.onDragStart,onDragEnd:function(e,n,r,o){o&&(a.formatChanged=!0),"arrow"==a.info.cmd&&a.calculateActualPos(r),t.onDragEnd(e,n,r)}};return"rect"==a.info.cmd?(0,P.jsx)(Z,ut(ut({},n),a.info)):"ellipse"==a.info.cmd?(0,P.jsx)(R,ut(ut({},n),a.info)):(0,P.jsx)(B,ut(ut({},n),a.info))},a.handleChangeColor=function(e){a.formatChanged=!0,a.options.onUpdate(a.md5,{format:{color:e}})},a.handleChangeWeight=function(e){a.formatChanged=!0;var t=a.info.format.weight;a.options.onUpdate(a.md5,{width:a.info.width-t+e,height:a.info.height-t+e,format:{weight:e}}),"arrow"==a.info.cmd&&a.calculateActualPos(p()(a.info,["left","top","right","bottom"]))},a.canReset=function(){return a.formatChanged},a.reset=function(e){a.options.onUpdate(a.md5,{format:Nt})},a.code4Property=function(e){return(0,P.jsx)(Je,ut(ut({start:a.start,end:a.end,md5:a.md5,ref:a.referForm,timeRangeBySec:a.timeRangeBySec},a.info.format),{},{maxTime:e,handleChangeWeight:a.handleChangeWeight,handleChangeColor:a.handleChangeColor,onChangeEnd:function(e){a.onChangeEnd(e)},onChangeStart:function(e){a.onChangeStart(e)}}))};var i=a.size;return a.displayWidth=i.width,a.displayHeight=i.height,a.posHash="",a}return wt(n,[{key:"bgColor",get:function(){return this.info.format.color}},{key:"size",get:function(){return this.info.width&&this.info.height?{width:this.info.width,height:this.info.height}:{width:this.info.right-this.info.left,height:this.info.bottom-this.info.top}}},{key:"calculateActualPos",value:function(e){var t=(0,f.OT)(e);if(this.posHash!=t){this.posHash=t;var n=document.querySelector("#svg-g-".concat(this.md5));if(n){var r=n.getBBox({markers:!0});return Object.assign(e,{x:r.x,y:r.y,width:r.width,height:r.height})}}return e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&e.hasOwnProperty("width")&&e.hasOwnProperty("height")?e:p()(this.info,["x","y","width","height"])}},{key:"shouldbeUpload",value:function(){return this.info.right-this.info.left!=0&&this.info.bottom-this.info.top!=0}},{key:"refreshUI",value:function(){if(this.referSimulatorItem&&this.referSimulatorItem.current){var e=this.size;this.referSimulatorItem.current.refreshUI(e,this.info)}this.referForm&&this.referForm.current&&this.referForm.current.refreshUI(this.start,this.end,this.info.format)}}],[{key:"typeDef",value:function(e){if(!e)return{};var t=e.screenPos,n=e.width,r=e.height,o=e.left,a=e.top,i=e.right,c=e.bottom;return t&&("string"==typeof t.width&&(t.width=parseFloat(t.width)),"string"==typeof t.height&&(t.height=parseFloat(t.height))),"string"==typeof i&&(e.right=parseFloat(i)),"string"==typeof c&&(e.bottom=parseFloat(c)),n||(e.width=Math.abs(s.ZP.minus(i,o))),r||(e.height=Math.abs(s.ZP.minus(c,a))),e}},{key:"Create",value:function(e,t,r,o,a){var i=(0,f.zs)(Zt);return i.md5=r,i.cmd=e,i.start=s.ZP.round(t,1),i.start>t&&(i.start-=.1),i.duration=Et(o),i.start+i.duration>o.videoDuration&&(i.start=o.videoDuration-i.duration),i.format=(0,f.zs)(Nt),i.screenPos=(0,f.zs)(o.screenPos),i.zIndex=(new Date).getTime(),new n(o,i,a).calculatePosition(o.videoBound)}}]),n}(Vt),qt=function(e){ft(n,e);var t=pt(n);function n(e,r,o){var a;xt(this,n),(a=t.call(this,e,n.typeDef(r),"blur",o)).calculatePosition=function(e){return e&&(a.info.x=(e.width-Ct)/2,a.info.y=(e.height-At)/2,!a.info.scale&&a.info.screenPos&&(a.info.scale=e.width/a.info.screenPos.width),a.info.left=a.info.x,a.info.top=a.info.y,a.info.right=a.info.x+Ct,a.info.bottom=a.info.y+At,a.info.width=Ct,a.info.height=At,a.info.range={width:e.width,height:e.height},a.readOnly=!1),gt(a)},a.ctInBar=function(){return(0,P.jsx)(G.Z,{className:"ct-symbol",style:{color:a.color},component:ot.Z})},a.code4Paint=function(e,t){var n={width:a.info.width,height:a.info.height,key:a.md5,readonly:e||a.readOnly,show:a.canBeShown(t.currentTime),ref:a.referSimulatorItem,selectedBlur:t.selectedBlur,current:t.selectedMd5,md5:a.md5,scale:t.scale,retrieveCanvas:t.retrieveCanvas,onSelect:t.onSelect,onDragStart:t.onDragStart,onDragEnd:function(e,n,r,o){o&&(a.formatChanged=!0),t.onDragEnd(e,n,r)}};return(0,P.jsx)(N,ut(ut({},n),a.info))},a.handleChangeBlur=function(e){a.formatChanged=!0,a.options.onUpdate(a.md5,{format:{blur:e}})},a.code4Property=function(e){return(0,P.jsx)(Ke,{start:a.start,end:a.end,blur:a.info.format.blur,md5:a.md5,ref:a.referForm,timeRangeBySec:a.timeRangeBySec,maxTime:e,handleChangeBlur:a.handleChangeBlur,onChangeEnd:function(e){a.onChangeEnd(e)},onChangeStart:function(e){a.onChangeStart(e)}})};var i=a.size;return a.displayWidth=i.width,a.displayHeight=i.height,a.posHash="",a.readOnly=!0,a.blurkey=(0,f.OT)([i,a.info.x,a.info.y,a.info.start,a.info.duration,a.info.format.blur]),a}return wt(n,[{key:"bgColor",get:function(){return this.info.format.color}},{key:"color",get:function(){return"white"}},{key:"refreshUI",value:function(){this.blurkey=(0,f.OT)([this.size,this.info.x,this.info.y,this.info.start,this.info.duration,this.info.format.blur]),this.referForm&&this.referForm.current&&this.referForm.current.refreshUI(this.start,this.end,this.info.format.blur),this.referSimulatorItem&&this.referSimulatorItem.current&&this.referSimulatorItem.current.refreshUI(this.info.format.blur)}},{key:"size",get:function(){return this.info.width&&this.info.height?{width:this.info.width,height:this.info.height}:{width:this.info.right-this.info.left,height:this.info.bottom-this.info.top}}},{key:"shouldUpdateImage",value:function(){return!1}},{key:"shouldbeUpload",value:function(){return this.info.right-this.info.left!=0&&this.info.bottom-this.info.top!=0}}],[{key:"typeDef",value:function(e){if(!e)return{};var t=e.screenPos,n=e.width,r=e.height,o=e.left,a=e.top,i=e.right,c=e.bottom;return t&&("string"==typeof t.width&&(t.width=parseFloat(t.width)),"string"==typeof t.height&&(t.height=parseFloat(t.height))),"string"==typeof i&&(e.right=parseFloat(i)),"string"==typeof c&&(e.bottom=parseFloat(c)),n||(e.width=Math.abs(s.ZP.minus(i,o))),r||(e.height=Math.abs(s.ZP.minus(c,a))),e}},{key:"Create",value:function(e,t,r,o){var a=(0,f.zs)(Zt);return a.md5=t,a.start=s.ZP.round(e,1),a.start>e&&(a.start-=.1),a.format={blur:10,color:Pt},a.duration=Et(r),a.start+a.duration>r.videoDuration&&(a.start=r.videoDuration-a.duration),a.screenPos=(0,f.zs)(r.screenPos),a.zIndex=(new Date).getTime(),new n(r,a,o).calculatePosition(r.videoBound)}}]),n}(Vt),Xt=function(e){ft(n,e);var t=pt(n);function n(e,r,o){var a;xt(this,n),(a=t.call(this,e,n.typeDef(r),"image",o)).trackURLImageSize=function(e){var t=gt(a);return new Promise((function(n,r){y()({method:"get",url:e,responseType:"blob"}).then((function(e){t.localImageFile=new File([e.data],t.contentImageKey+".png"),t._localImageUrl=URL.createObjectURL(t.localImageFile),(0,f.Ad)(t.localImageFile,(function(e){t.imgSize=(0,f.zs)(e),n(t.imgSize)}))})).catch((function(n){t._localImageUrl=e;var o=document.createElement("IMG");o.onload=function(){t.imgSize={height:o.height,width:o.width}},o.src=e,r(n.message)}))}))},a.prepareUploadSnapshot=function(e){var t=gt(a);return new Promise((function(e,n){t._snapshotKey=(0,f.D_)(),t.localImageFile?(0,f.Ad)(t.localImageFile,(function(n,r){var o=document.createElement("canvas"),a=4*t.info.format.shadow;o.width=t.size.width+2*t.info.format.border+2*a,o.height=t.size.height+2*t.info.format.border+2*a;var i=o.getContext("2d",{alpha:!0});i.lineWidth=t.info.format.border,t.info.format.border>0&&(i.strokeStyle=t.info.format.color),i.globalAlpha=t.info.format.alpha,t.info.format.border>0&&i.strokeRect(t.info.format.border/2+a,t.info.format.border/2+a,o.width-t.info.format.border-2*a,o.height-t.info.format.border-2*a),i.shadowColor="rgba(0,0,0,0.4)",a>0?(i.filter="drop-shadow(0px 2px 4px rgba(0,0,0,0.4))",i.shadowBlur=a):(i.shadowBlur=0,i.filter="none"),i.drawImage(r,t.info.format.border+a,t.info.format.border+a,t.size.width,t.size.height),t.info.snapshotType="image/png",o.toBlob((function(n){t._localFile=new File([n],t.snapshotKey+".png"),e(t)}),t.info.snapshotType,.8)})):n("no local file")}))},a.calculatePosition=function(e,t){if(e){var n=e.width/t.width,r=e.height/t.height,o=1;(n<1||r<1)&&(o=n<r?n:r);var i=t.width*o,s=t.height*o;a.info.x=(e.width-i)/2,a.info.y=(e.height-s)/2,!a.info.scale&&a.info.screenPos&&(a.info.scale=e.width/a.info.screenPos.width),a.info.left=a.info.x,a.info.top=a.info.y,a.info.right=a.info.x+i,a.info.bottom=a.info.y+s,a.info.width=i,a.info.height=s,a.info.range={width:e.width,height:e.height}}return gt(a)},a.dataforUpload=function(){for(var e in a.info)if(a.info.hasOwnProperty(e)){var t=a.info[e];Number(t)===t&&t%1!=0&&(a.info[e]=s.ZP.round(t,1))}var n=0;return a.info.format.shadow>0&&(n=4*a.info.format.shadow),a.info.x=a.info.left-(a.info.format.border+n),a.info.y=a.info.top-(a.info.format.border+n),ut(ut({},a.info),{},{md5:a.md5})},a.ctInBar=function(){return(0,P.jsx)(G.Z,{className:"ct-symbol",style:{color:"#F6F6F6"!=a.bgColor?"white":"red"},component:ct})},a.code4Paint=function(e,t){var n=gt(a),r={width:a.info.width,height:a.info.height,imageURL:a.displayImageUrl,showPlaceholder:null==a.localImageFile,key:a.md5,readonly:e||null!=document.fullscreenElement,show:a.canBeShown(t.currentTime),ref:a.referSimulatorItem,current:t.selectedMd5,selectedBlur:t.selectedBlur,md5:a.md5,imageSize:a.imgSize,scale:t.scale,retrieveCanvas:t.retrieveCanvas,onSelect:t.onSelect,onDragStart:t.onDragStart,onDragEnd:function(e,r,o,a){a&&(n.formatChanged=!0),t.onDragEnd(e,r,o)}};return(0,P.jsx)(T,ut(ut({},r),a.info))},a.handleChangeAlpha=function(e){a.formatChanged=!0,a.options.onUpdate(a.md5,{format:{alpha:e}})},a.handleChangeShadow=function(e){a.formatChanged=!0,a.options.onUpdate(a.md5,{format:{shadow:e}})},a.handleChangeBorder=function(e){a.formatChanged=!0,a.options.onUpdate(a.md5,{format:{border:e}})},a.handleChangeColor=function(e){a.formatChanged=!0,a.options.onUpdate(a.md5,{format:{color:e}})},a.code4Property=function(e){return(0,P.jsx)(Ye,ut(ut({start:a.start,end:a.end,md5:a.md5,ref:a.referForm,timeRangeBySec:a.timeRangeBySec,maxTime:e},a.info.format),{},{handleChangeColor:a.handleChangeColor,handleChangeBorder:a.handleChangeBorder,handleChangeShadow:a.handleChangeShadow,handleChangeAlpha:a.handleChangeAlpha,onChangeEnd:function(e){a.onChangeEnd(e)},onChangeStart:function(e){a.onChangeStart(e)}}))},a.imgSize=null,a._localImageUrl=null,a._localCtImageFile=null,r.tempImageSize&&(a.imgSize=(0,f.zs)(r.tempImageSize),delete a.info.tempImageSize);var i=a.size;return a.displayWidth=i.width,a.displayHeight=i.height,a.posHash="",r.tempImageSaveObj?(a.imageNeedSave=r.tempImageSaveObj.value,delete a.info.tempImageSaveObj):a.imageNeedSave=!1,a}return wt(n,[{key:"displayImageUrl",get:function(){return this._localImageUrl}},{key:"contentImageServerKey",get:function(){return"image/png"==this.contentType?this.contentImageKey+".png":this.contentImageKey+".jpg"}},{key:"contentType",get:function(){return this.info.contentType},set:function(e){this.info.contentType=e,this.contentImageKey=(0,f.D_)()}},{key:"localImageFile",get:function(){return this._localCtImageFile},set:function(e){this._localCtImageFile=e}},{key:"contentImageKey",get:function(){return this.info.contentImageKey},set:function(e){this.info.contentImageKey=e}},{key:"bgColor",get:function(){return this.info.format.color}},{key:"refreshUI",value:function(){this.referForm&&this.referForm.current&&this.referForm.current.refreshUI(this.start,this.end),this.referSimulatorItem&&this.referSimulatorItem.current&&this.referSimulatorItem.current.refreshUI(this.info.format.alpha,this.info.format.border,this.info.format.color,this.info.format.shadow)}},{key:"size",get:function(){return this.info.width&&this.info.height?{width:this.info.width,height:this.info.height}:{width:this.info.right-this.info.left,height:this.info.bottom-this.info.top}}},{key:"shouldbeUpload",value:function(){return this.info.right-this.info.left!=0&&this.info.bottom-this.info.top!=0}},{key:"getJSONInfo",value:function(){return JSON.stringify(ut({tempImageSize:this.imgSize,tempImageSaveObj:{value:this.imageNeedSave}},this.info))}},{key:"refreshInfo",value:function(){return ut(ut({},this.info),{},{imageSize:this.imgSize,isLittleScreenMode:this.env.isLittleScreenMode})}}],[{key:"typeDef",value:function(e){if(!e)return{};var t=e.screenPos,n=e.width,r=e.height,o=e.left,a=e.top,i=e.right,c=e.bottom;return t&&("string"==typeof t.width&&(t.width=parseFloat(t.width)),"string"==typeof t.height&&(t.height=parseFloat(t.height))),"string"==typeof i&&(e.right=parseFloat(i)),"string"==typeof c&&(e.bottom=parseFloat(c)),n||(e.width=Math.abs(s.ZP.minus(i,o))),r||(e.height=Math.abs(s.ZP.minus(c,a))),e}},{key:"Create",value:function(e,t,r,o,a,i){var c=(0,f.zs)(Zt);c.md5=o,c.format=Tt,c.start=s.ZP.round(r,1),c.start>r&&(c.start=s.ZP.minus(c.start,.1)),c.contentType="image/png",c.duration=Et(a),c.start+c.duration>a.videoDuration&&(c.start=a.videoDuration-c.duration),c.screenPos=(0,f.zs)(a.screenPos),c.zIndex=(new Date).getTime();var l=new n(a,c,i);return e&&(l.localImageFile=e,l.contentType=e.type,l._localImageUrl=URL.createObjectURL(e),l.imgSize=t,l.calculatePosition(a.videoBound,t),l.imageNeedSave=!0),l}}]),n}(Vt),Kt=function(e){ft(n,e);var t=pt(n);function n(e,r,o){var a;return xt(this,n),(a=t.call(this,e,r,"cut",o)).ctInBar=function(){return(0,P.jsx)(G.Z,{className:"ct-symbol",style:{color:a.color},component:$e.Z})},a.code4Property=function(e){return(0,P.jsx)(Xe,{start:a.start,end:a.end,md5:a.md5,ref:a.referForm,timeRangeBySec:a.timeRangeBySec,maxTime:e,onChangeEnd:function(e){a.onChangeEnd(e)},onChangeStart:function(e){a.onChangeStart(e)}})},a}return wt(n,[{key:"bgColor",get:function(){return"transparent"}},{key:"refreshUI",value:function(){this.referForm&&this.referForm.current&&this.referForm.current.refreshUI(this.start,this.end)}}],[{key:"Create",value:function(e,t,r,o){var a=(0,f.zs)(Bt);return a.md5=t,a.duration=Et(r),a.start=s.ZP.round(e,1),a.start>e&&(a.start-=.1),new n(r,a,o)}}]),n}(Lt);function Gt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jt(e){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jt(e)}function $t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function en(e,t,n){return t&&Qt(e.prototype,t),n&&Qt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var tn=a.Z.confirm,nn=function(e,t,n){var r=s.ZP.round(n/t,4),o=[0],a=[];return e.length>1?(o=o.concat(e.map((function(e){return s.ZP.round(s.ZP.times(e.end,r),4)}))),(a=e.map((function(e){return s.ZP.round(s.ZP.times(e.start,r),4)}))).push(s.ZP.round(s.ZP.times(t,r),4)),a.shift()):a.push(s.ZP.round(s.ZP.times(t,r),4)),e.map((function(e,t){var n={left:o[t],right:a[t]+10};return e.timeRangeBySec={min:s.ZP.round(s.ZP.divide(n.left,r),1),max:s.ZP.round(s.ZP.divide(n.right-10,r),1)},{key:e.md5,md5:e.md5,type:e.type,content:e.ctInBar(),color:e.color,ref:e.onReferBar,borderColor:e.borderColor,bgColor:e.bgColor,left:s.ZP.round(s.ZP.times(e.start,r),4),width:s.ZP.round(s.ZP.times(e.duration,r)+10,4),timeRange:n}}))},rn=function e(t,n,r){if(t&&t.length>n+1){var o=t[n+1];if(o)return r<o.start?r:e(t,n+1,o.start+o.duration)}return r},on=function e(t,n,r,o){if(t&&n-1>=0){var a=t[n-1];if(a){var i=a.start+a.duration;if(i>=o)return e(t,n-1,r,a.start);if(i>=o-r)return i}}return o-r},an=function(){function e(t){var n=this;$t(this,e),this.annCanBeAdd=function(e){if(!n.marks)return!1;var t=10*s.ZP.round(e.start,1),r=10*s.ZP.round(e.end,1)+1;return 0==n.marks.subarray(t,r).reduce((function(e,t){return e+t}))},this.isEmpty=function(){return 0==Object.keys(n.data).length},this.isAnnInTrack=function(e){return null!=n.data[e]},this.checkValidTime=function(e,t){if(n.marks){var r=10*s.ZP.round(e,1),o=10*s.ZP.round(e+t,1);if(0==n.marks.subarray(r,o).reduce((function(e,t){return e+t}))){var a=n.marks.indexOf(1,o);a=a<0?s.ZP.round((n.marks.length-1)/10,1):s.ZP.round((a-1)/10,1);for(var i=0,c=r;c>=0;c--)if(1==n.marks[c]){i=s.ZP.round(c/10,1);break}return{start:s.ZP.round(r/10,1),duration:t,timeRange:{left:i,right:a}}}var l=n.marks.join(""),u=new Uint8Array(Math.floor(10*t)).join(""),d=r,f=r,h=n.marks.length-1;if(1==n.marks[r]){if(-1==(d=l.indexOf(u,r)))return;f=d,-1==(h=n.marks.indexOf(1,d))&&(h=n.marks.length-1)}else{if(h=l.indexOf("1",r),-1==(d=l.lastIndexOf(u,h)))return;-1==(f=l.lastIndexOf("1",d))&&(f=0)}return{start:s.ZP.round(d/10,1),duration:t,timeRange:{left:s.ZP.round(f/10,1),right:s.ZP.round(h/10,1)}}}},this.addAnn=function(e){if(n.marks&&e&&e.md5){n.data[e.md5]=e;var t=10*s.ZP.round(e.start,1),r=10*s.ZP.round(e.end,1);n.marks.fill(1,t,r)}},this.dataInfo=function(){return Object.values(n.data).map((function(e){return e&&e.refreshInfo?e.refreshInfo():{}}))},this.addAnns=function(e){var t=e.length,r=n;return e.forEach((function(e,t){r.addAnn(e)})),Object.keys(n.data).length>=t},this.annsForUpload=function(e){return Object.keys(n.data).filter((function(t){return e.includes(t)}))},this.updateTrack=function(){for(var e in n.marks=new Uint8Array(s.ZP.round(10*n.duration,0)),n.data){var t=n.data[e];if(t){var r=10*s.ZP.round(t.start,1),o=10*s.ZP.round(t.end,1);n.marks.fill(1,r,o)}}},this.removeAnn=function(e){var t=n.data[e];if(t){if(n.marks){var r=10*s.ZP.round(t.start,1),o=10*s.ZP.round(t.end,1);n.marks.fill(0,r,o)}delete n.data[e]}},this._duration=t,t&&(this.marks=new Uint8Array(s.ZP.round(10*t,0))),this.data={}}return en(e,[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e,this.marks=new Uint8Array(s.ZP.round(10*e,0))}}]),e}(),sn=function(){function e(t){var n=this;$t(this,e),this.updateVideo=function(e){n.videoID=e,n.resetBaseVersion("")},this.save=function(e,t,r,o){var a=t.tracks,l=t.anns,u=t.deleteImages,d=t.cuts,h=[],p=[],m=[],g=n.baseVersion,y=n,v=!1;if(d.length>0){var x=0,b=function(e,t){if(!t||t.length<=0)return[];var n=t.sort((function(e,t){return e.sortStart-t.sortStart})).map((function(e){return[e.start,e.start+e.duration]})),r=[],o=0,a=n.length;return n.every((function(t,n){return o<t[0]&&r.push([o,t[0]]),!((o=o>t[1]?o:t[1])>=e||(a-1==n&&r.push([o,e]),0))})),r.filter((function(e){return s.ZP.minus(e[1],e[0])>.1}))}(e,d);if(b&&b.length>0&&(x=b.map((function(e){return e[1]-e[0]})).reduce((function(e,t){return e+t}))),x<1)return void tn({title:"Do you want to delete this item?",maskStyle:{zIndex:10500},zIndex:10500,icon:(0,P.jsx)(i.Z,{}),content:"Cutting an entire video is not allowed. If you want to delete the video, go back to the video details page.",onOk:function(){o&&o(!1)},onCancel:function(){o&&o(!1)}});v=!0,g=(0,f.D_)(),h.push((0,c.IQ2)(n.videoID,"cut",n.baseVersion,g,b.map((function(e){return{start:s.ZP.round(e[0],1),duration:s.ZP.round(e[1]-e[0],1)}})),[])),m=function(e,t,n){var r=[];return t.every((function(t,n){var o=t.info,a=o.start,i=o.duration;if(t.shouldbeUpload()){var c=a+i,l=0,u=0,d=e.length;e.every((function(e,t){if(a<e[0]){if((u<=a||0==t)&&(a=l),c<e[0])return(u<=c||0==t)&&(c=l),!1;if(c>=e[0]&&c<e[1])return c=l+(c-e[0]),!1;if(t==d-1)return c=l+(e[1]-e[0]),!1}else if(a>=e[0]&&a<e[1]){if(a=l+(a-e[0]),c<e[1])return c=l+(c-e[0]),!1;t==d-1&&(c=l+(e[1]-e[0]))}else t==d-1&&(a=l,c=l);return l+=e[1]-e[0],u=e[1],!0})),c-a>0&&(t.start=s.ZP.round(a,1),t.duration=s.ZP.round(s.ZP.minus(c,a),1),r.push(t))}return!0})),r}(b,l,n.env),p=m.filter((function(e){return e.shouldUpdateImage()})).map((function(e){return e.prepareUploadSnapshot(y.env)}))}else p=(m=l.filter((function(e){return e.shouldbeUpload()}))).filter((function(e){return e.shouldUpdateImage()})).map((function(e){return e.prepareUploadSnapshot(y.env)}));var w=function(e){e.length>0?Promise.all(e).then((function(e){m.forEach((function(e,t){e.updateSnapshotKey()})),y.uploadAnnotaions(m,a,u,g,r,v,o)})).catch((function(e){o&&o(!1,e)})):y.uploadAnnotaions(m,a,u,g,r,v,o)},j=m.filter((function(e){return"image"==e.type}));p&&p.length>0?Promise.all(p).then((function(e){e.length>0?n.uploadActionImages(e,j,(function(e,t){e?(t&&(h=h.concat(t)),w(h)):o&&o(!1,new Error("Network error, please try again later."))})):w(h)})).catch((function(e){o&&o(!1,e)})):j.length>0?n.uploadActionImages([],j,(function(e,t){e?(t&&(h=h.concat(t)),w(h)):o&&o(!1,new Error("Network error, please try again later."))})):w(h)},this.uploadAnnotaions=function(e,t,r,a,i,s,l){var u=e.filter((function(e){return"blur"!=e.type})).map((function(e){return e.dataforUpload()})),d=Object.values(e.filter((function(e){return"blur"==e.type})).reduce((function(e,t){return e[t.blurkey]=t.dataforUpload(),e}),{}));if(e.length>0||n.annsOriginalHash!=(0,f.OT)(e)){var h=[];if(d&&d.length>0){var p=(0,f.D_)();h.push((0,c.IQ2)(n.videoID,"blur",a,p,d,[])),a=p,!0}if(i){var m=u.map((function(e){return e.md5}));t=t.map((function(e){return e.annsForUpload(m)}));var g=(0,f.D_)();h.push((0,c.IQ2)(n.videoID,"annotation",a,g,u,t))}r&&r.length>0&&h.push((0,c.iQz)(n.videoID,r)),h.length>0?Promise.all(h).then((function(){l&&l(!0)})).catch((function(e){o.ZP.error("Something went wrong. Please try again later.",3),l&&l(!1,e)})):l&&l(!0)}else l&&l(!0)},this.loadImageAnnotationURL=function(e,t,r){!e||e.length<=0?r&&r(!1):(0,c.jTH)(n.videoID,e,t).then((function(e){r&&r(!0,e)})).catch((function(e){o.ZP.error("Image load failed"),r&&r(!1)}))},this.uploadActionImages=function(e,t,r){var o={},a=e.filter((function(e){return e.shouldUpdateImage()&&e.localSnapshotFile&&e.snapshotKey&&e.snapshotKey.length>0})).map((function(e){var t=e.snapshotKey+".png";return"image/jpeg"==e.snapshotType&&(t=e.snapshotKey+".jpg"),o[t]=e,t})),i=t.filter((function(e){return e.imageNeedSave})).map((function(e){var t=e.contentImageServerKey;return o[t]=e,t}));a.length<=0&&i.length<=0?r&&r(!0):(0,c.ajT)(n.videoID,a.concat(i)).then((function(e){var t=e.data;if(t){var n=[],s="https://awevideo.s3.amazonaws.com/";for(var l in window.location&&window.location.host&&window.location.host.indexOf("aws.cn")&&(s="https://awevideotest.s3.amazonaws.com/"),t)if(t.hasOwnProperty(l)){var u=t[l],d=o[l],f=null,h="";a.includes(l)&&(l.indexOf(".")>=0&&(l=l.split(".")[0]),f=d.localSnapshotFile,h=d.snapshotType),i.includes(l)&&(f=d.localImageFile,h=d.contentType),f&&n.push((0,c.p7n)({AWSAccessKeyId:"AKIAJSCJQ2NM3XLFPVKA",acl:"private",key:u.s3key,"Content-Type":h,policy:u.policy,signature:u.signature,file:f},(function(){}),u.bucket?"https://".concat(u.bucket,".s3.amazonaws.com/"):s))}n.length>0?r&&r(!0,n):r&&r(!1)}else r&&r(!1)})).catch((function(e){r&&r(!1,e)}))},this.updateVideo(t)}return en(e,[{key:"canRequestNetwork",value:function(){return!this.annotationLoaded&&!this.annotationLoading&&this.networkFailed<e.NETWORK_MAX_REQ}},{key:"resetBaseVersion",value:function(e){this.baseVersion=e,this.annotationLoaded=!1,this.annotationLoading=!1,this.networkFailed=0,this.currentVersion=""}},{key:"loadAnnotations",value:function(e,t,n){if(!this.videoID||this.videoID.length<=0)o.ZP.warning("Data Error: Invalid videoID, can't load annotations.",5);else{this.annotationLoading=!0;var r=this;(0,c.n6q)(this.videoID,this.baseVersion,e).then((function(e){r.annotationLoaded=!0,r.annotationLoading=!1;var t=e.actions;if(t&&t.length>0){var o=t[0];if(o){r.currentVersion=o.version;var a=JSON.parse(o.data);if(a)return void(n&&n(!0,a,"annotation"))}}n&&n(!0,{},"annotation")})).catch((function(e){r.annotationLoading=!1,r.networkFailed++,n&&n(!1,e)})),t&&(0,c.n6q)(this.videoID,this.baseVersion,e,"blur").then((function(e){var t=e.actions;if(t&&t.length>0){var r=t[0];if(r&&r.data&&r.data.length>2){var o=JSON.parse(r.data);if(o)return void(n&&n(!0,o,"blur"))}}n&&n(!0,{},"blur")}))}}}]),e}();sn.NETWORK_MAX_REQ=3;var cn=en((function e(t,n){var a=this;$t(this,e),this.reset=function(){if(a.annotations&&Object.values(a.annotations).length>0)for(var e in a.annotations)a.annotations.hasOwnProperty(e)&&delete a.annotations[e];if(a.annotations={},a.cuts&&Object.values(a.cuts).length>0)for(var t in a.cuts)a.cuts.hasOwnProperty(t)&&delete a.cuts[t];a.cuts={},a.env={},a.currentVersion="",a.deleteImages={},a.imagesNeedFetch={},a.annsHash="",a.originAnnHash="",a.cutsHash="",a.unredoManager&&delete a.unredoManager,a.unredoManager=new d,a.annotationParseData=null,a.annotationBlurParseData=null,a.tracks=[],a.trackedAnnHash="",a.respSortedCuts=[]},this.tracksHashSource=function(e){return a.readonly||e?Object.values(a.annotations).map((function(e){return e.info})):a.tracks.map((function(e){return e.dataInfo()}))},this.cutsHashSource=function(){return Object.values(a.cuts).map((function(e){return e.info}))},this.updateEnv=function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];"object"===Jt(n)?a.env[t]=(0,f.zs)(n):a.env[t]=n,"videoDuration"==t&&e.videoDuration>0&&(a.annotationParseData||a.annotationBlurParseData?(a.parseData(a.annotationParseData),a.parseData(a.annotationBlurParseData),a.annotationParseData=null,a.annotationBlurParseData=null,a.annotationImageUrls&&a.updateImageUrl(a.annotationImageUrls)):(!a.tracks||a.tracks.length<=0)&&a.transferAnnsToTrack())}},this.updateImageUrl=function(e){if(a.annotationParseData)a.annotationImageUrls=e;else{var t=Object.values(a.annotations).map((function(t){var n=e[t.contentImageServerKey];return n?t.trackURLImageSize(n):{}}));a.annotationImageUrls=null;var n=a;Promise.all(t).then((function(e){n.annsHash=(0,f.OT)(n.tracksHashSource()),n.callbacks.updateAnns&&n.callbacks.updateAnns(n.annsHash,!1)})).catch((function(e){}))}},this.getDatasToSave=function(){return{tracks:a.tracks,anns:a.buildAnnsForSimulator(),deleteImages:Object.keys(a.deleteImages),cuts:Object.values(a.cuts)}},this.parseData=function(e,t){if(a.readonly||a.env.videoDuration&&!(a.env.videoDuration<=0)){if(e&&e.hasOwnProperty("actions")){var n=a.transferLocal(e.actions);if(a.readonly)a.annsHash=(0,f.OT)({random:Math.random()}),a.originAnnHash=a.annsHash;else if("annotation"==t)e.hasOwnProperty("tracks")&&e.tracks?a.transferLocalWithTrack(e.tracks):a.transferAnnsToTrack();else{var r=a;n.forEach((function(e,t){r.addAnnotaionToTrack(e)})),a.annsHash=(0,f.OT)(a.tracksHashSource(!0)),a.originAnnHash=a.annsHash}}a.callbacks.updateAnns&&a.callbacks.updateAnns(a.annsHash,!1)}else"annotation"==t?a.annotationParseData=e:a.annotationBlurParseData=e},this.transferLocalWithTrack=function(e){var t=a.env.videoDuration;a.tracks=[];var n=a;e.every((function(e,r){var o=new an(t);return n.tracks.push(o),o.addAnns(e.map((function(e){return n.annotations[e]})))}))?(n.annsHash=(0,f.OT)(n.tracksHashSource(!0)),a.originAnnHash=a.annsHash):a.transferAnnsToTrack()},this.transferLocal=function(e){if(!e||e.length<=0)return[];var t=a;try{return a.getValidList(e).map((function(e){var n,r=e.type;return r||(e.link&&e.link.length>0?r="link":(!e.content||e.content.length<=0)&&(r="shape")),"shape"==r?(n=new Wt(t.env,e,{onUpdate:t.onAnnActionChange}),t.annotations[n.md5]=n):"image"==r?(n=new Xt(t.env,e,{onUpdate:t.onAnnActionChange}),t.annotations[n.md5]=n):"blur"==r?(n=new qt(t.env,e,{onUpdate:t.onAnnActionChange}),t.annotations[n.md5]=n):(n=new Ht(t.env,e,r,{onUpdate:t.onAnnActionChange}),t.annotations[n.md5]=n),n}))}catch(e){}return[]},this.refreshAnnScreenPos=function(e,t){for(var n in a.annotations)if(a.annotations.hasOwnProperty(n)){var r=a.annotations[n];r&&r.updateInfo&&r.updateInfo({screenPos:e,range:t})}a.annsHash=(0,f.OT)(a.tracksHashSource())},this.onAnnActionChange=function(e,t){a.updateAction(e,t)},this.addAnnotaionToTrack=function(e){if(e){var t=a.tracks.filter((function(t){return t.annCanBeAdd(e)}));if(t&&t.length>0)t[0].addAnn(e);else{var n=new an(a.env.videoDuration);a.tracks.push(n),n.addAnn(e)}}},this.updateTrackForAnnotation=function(e){var t=a.tracks.filter((function(t){return t.isAnnInTrack(e)}));t&&t.length>0&&t[0].updateTrack()},this.createAction=function(e,t,n){var r=(0,f.D_)(),i={};if("cut"==t){var s=Object.values(a.cuts).sort((function(e,t){return e.sortStart-t.sortStart})),c=function(e,t,n,r){var o=r.filter((function(t){return t.start<=e&&t.start+t.duration>=e}));if(o.length>0){var a=o[0],i=r.indexOf(a);(e=rn(r,i,a.start+a.duration))>=n&&(e=i>0?on(r,i,t,a.start):a.start-t)}return e<0&&(e=0),e}(e,Et(a.env),a.env.videoDuration,s);a.cuts[r]=Kt.Create(c,r,a.env,{onUpdate:a.onAnnActionChange}),i=a.cuts[r];var l=e!=c,u=(s=Object.values(a.cuts).sort((function(e,t){var n=e.sortStart-t.sortStart;return 0!=n?n:t.date-e.date}))).indexOf(i);if(s.length>u+1){var h=s[u+1].start-i.start;i.duration>h&&(i.duration=h)}else if(i.end>a.env.videoDuration)if(1==i.duration){var p=a.env.videoDuration-1;p<0?(i.start=0,i.duration=a.env.videoDuration):l&&i.start>p?i.duration=a.env.videoDuration-i.start:i.start=p}else i.duration=a.env.videoDuration-i.start;if(i.duration<=0||1==i.duration&&u>0&&i.end>=a.env.videoDuration&&i.start<s[u-1].end)return delete a.cuts[r],o.ZP.warning("Something went wrong. The video is too short.",3),"";a.cutsHash=(0,f.OT)(a.cutsHashSource())}else"text"==t||"link"==t?(a.annotations[r]=Ht.Create(e,r,t,a.env,{onUpdate:a.onAnnActionChange}),setTimeout((function(){i.focus()}),700)):a.annotations[r]="image"==t?Xt.Create(n.file,n.size,e,r,a.env,{onUpdate:a.onAnnActionChange}):"blur"==t?qt.Create(e,r,a.env,{onUpdate:a.onAnnActionChange}):Wt.Create(n.cmd,e,r,a.env,{onUpdate:a.onAnnActionChange}),i=a.annotations[r],a.addAnnotaionToTrack(i),a.annsHash=(0,f.OT)(a.tracksHashSource());return a.unredoManager.doAddNewAction(d.ACTION_TYPE_ADD,r,i.getJSONInfo()),"cut"==t?a.callbacks.updateCuts&&a.callbacks.updateCuts(a.cutsHash,!0,r):a.callbacks.updateAnns&&a.callbacks.updateAnns(a.annsHash,!0,r),r},this.updateAction=function(e,t){var n=a.cuts[e],r="";if(n?r="cut":(n=a.annotations[e],r="annotation"),n){var o=n.getJSONInfo(),i=n.start;n.updateInfo(t),(t.start||t.duration)&&a.callbacks.updateVideoTime&&(t.start&&t.start!=i?a.callbacks.updateVideoTime(t.start):a.callbacks.updateVideoTime(n.end)),a.updateTrackForAnnotation(n.md5),a.unredoManager.doAddNewAction(d.ACTION_TYPE_UPDATE,e,n.getJSONInfo(),o),"cut"==r?(a.cutsHash=(0,f.OT)(a.cutsHashSource()),a.callbacks.updateCuts&&a.callbacks.updateCuts(a.cutsHash,!0)):(a.annsHash=(0,f.OT)(a.tracksHashSource()),a.callbacks.updateAnns&&a.callbacks.updateAnns(a.annsHash,!0))}},this.deleteAction=function(e,t){var n,r=a.cuts[e];r?(n="cut",delete a.cuts[e]):(r=a.annotations[e],a.tracks.forEach((function(t,n){t.removeAnn(e)})),n="annotation",delete a.annotations[e]),r?(r.unmount(),a.unredoManager.doAddNewAction(d.ACTION_TYPE_DELETE,e,r.getJSONInfo()),a.clearUnusedTrack(),"image"==r.type&&(a.deleteImages[r.contentImageServerKey]=r.localImageFile),"cut"==n?(a.cutsHash=(0,f.OT)(a.cutsHashSource()),a.callbacks.updateCuts&&a.callbacks.updateCuts(a.cutsHash,!0,"",t)):(a.annsHash=(0,f.OT)(a.tracksHashSource()),a.callbacks.updateAnns&&a.callbacks.updateAnns(a.annsHash,!0,"",t))):t&&t(!1)},this.createActionWithInfo=function(e,t){var n=e.md5;if("cut"==e.type)a.cuts[n]=new Kt(a.env,e,t);else{if("text"==e.type||"link"==e.type)a.annotations[n]=new Ht(a.env,e,e.type,t);else if("image"==e.type){var r=new Xt(a.env,e,t);if("image"==r.type){var o=a.deleteImages[r.contentImageServerKey];null!=o&&(r.localImageFile=o,r._localImageUrl=URL.createObjectURL(o)),delete a.deleteImages[r.contentImageServerKey]}a.annotations[n]=r}else"blur"==e.type?a.annotations[n]=new qt(a.env,e,t):a.annotations[n]=new Wt(a.env,e,t);var i=a.annotations[n];a.addAnnotaionToTrack(i)}},this.doUndo=function(e){var t=a;a.unredoManager.doUndo((function(n){if(n){var r=JSON.parse(n.data),o=n.md5,i=-1;if(n.actionType==d.ACTION_TYPE_ADD)"cut"==r.type?delete t.cuts[o]:(t.tracks.forEach((function(e,t){e.removeAnn(o)})),"image"==r.type&&(a.deleteImages[r.contentImageServerKey]=t.annotations[o].localImageFile),delete t.annotations[o],t.clearUnusedTrack()),o="";else if(n.actionType==d.ACTION_TYPE_DELETE)t.createActionWithInfo(r,{onUpdate:t.onAnnActionChange}),i=r.start+.1;else{var s=JSON.parse(n.prevData),c=a.getTrackIndexWithAnn(o);t.onStartDragFromTrack(o,c);var l=null;"cut"==r.type?((l=t.cuts[o]).info={},l.updateInfo(s)):((l=t.annotations[o]).info={},l.updateInfo(s),t.addAnnotaionToTrack(l)),i=s.start+.1}"cut"==r.type?t.cutsHash=(0,f.OT)(t.cutsHashSource()):t.annsHash=(0,f.OT)(t.tracksHashSource()),e&&e(o,i,"cut"==r.type?t.cutsHash:"","cut"!=r.type?t.annsHash:"")}}))},this.doRedo=function(e){var t=a;a.unredoManager.doRedo((function(n){if(n){var r=JSON.parse(n.data),o=n.md5,i=-1;if(n.actionType==d.ACTION_TYPE_ADD)t.createActionWithInfo(r,{onUpdate:t.onAnnActionChange}),i=r.start+.1;else if(n.actionType==d.ACTION_TYPE_DELETE)"cut"==r.type?delete t.cuts[o]:(t.tracks.forEach((function(e,t){e.removeAnn(o)})),delete t.annotations[o],t.clearUnusedTrack()),o="";else{JSON.parse(n.prevData);var s=a.getTrackIndexWithAnn(o);t.onStartDragFromTrack(o,s),"cut"==r.type?(t.cuts[o].info={},t.cuts[o].updateInfo(r)):(t.annotations[o].info={},t.annotations[o].updateInfo(r),t.addAnnotaionToTrack(t.annotations[o])),i=r.start+.1}"cut"==r.type?t.cutsHash=(0,f.OT)(t.cutsHashSource()):t.annsHash=(0,f.OT)(t.tracksHashSource()),e&&e(o,i,"cut"==r.type?t.cutsHash:"","cut"!=r.type?t.annsHash:"")}}))},this.repaintAnnotations=function(e,t){for(var n in a.annotations)if(a.annotations.hasOwnProperty(n)){var r=a.annotations[n];r.repaint&&r.repaint(e,t==n)}},this.getCutsForSimulator=function(){return Object.values(a.cuts)},this.buildAnnsForSimulator=function(){return Object.values(a.annotations).sort((function(e,t){return e.zIndex-t.zIndex}))},this.getValidList=function(e){var t=a.env.videoDuration;return!t||t<=0?a.readonly?e.sort((function(e,t){return e.start-t.start})):[]:e.filter((function(e){return e.start<t})).sort((function(e,t){return e.start-t.start})).map((function(e){return e.end>t&&(e.duration=s.ZP.minus(t,e.start)),e}))},this.onStartDragFromTrack=function(e,t){if(!(t<0||!a.tracks||t>=a.tracks.length)){var n=a.tracks[t];n&&n.removeAnn(e)}},this.clearUnusedTrack=function(){a.tracks=a.tracks.filter((function(e){return!e.isEmpty()}))},this.moveAnnToTrack=function(e,t){var n=a.tracks[e];if(n){if(n.addAnn(a.annotations[t]),a.annsHash=(0,f.OT)(a.tracksHashSource()),a.trackedAnnHash=a.annHash,a.callbacks.updateAnns){var r=a;setTimeout((function(){r.callbacks.updateAnns(r.annsHash,!0)}),100)}}else a.addTrackWithAnn(e,t)},this.addTrackWithAnn=function(e,t){var n=new an(a.env.videoDuration);if(a.tracks.splice(e,0,n),n.addAnn(a.annotations[t]),a.annsHash=(0,f.OT)(a.tracksHashSource()),a.trackedAnnHash=a.annHash,a.callbacks.updateAnns){var r=a;setTimeout((function(){r.callbacks.updateAnns(r.annsHash,!0)}),100)}},this.getTrackIndexWithAnn=function(e){return a.cuts[e]?-1:a.tracks.findIndex((function(t){return t.isAnnInTrack(e)}))},this.getValidTrackTime=function(e,t,n){var r=a.env.processbarLength,o=a.env.videoDuration;if(!r||r<=0||!o||o<=0)return null;var i=a.tracks[t];if(!i)return null;var c=a.annotations[e];if(!c)return null;var l=s.ZP.round(r/o,4),u=s.ZP.round(s.ZP.divide(n,l),4),d=i.checkValidTime(u,c.duration);return d?{lenPerSec:l,left:s.ZP.round(s.ZP.times(d.start,l),1),width:s.ZP.round(s.ZP.times(d.duration,l),1),timeRange:{left:s.ZP.round(s.ZP.times(d.timeRange.left,l),1),right:s.ZP.round(s.ZP.times(d.timeRange.right,l),1)}}:null},this.transferAnnsToTrack=function(){var e=a.env.videoDuration;if(!e||e<=0)return[];var t=Object.values(a.annotations);if(t.length<=0)return[];for(var n=[new an(e)],r=0,i=t;r<i.length;r++){var s,c=i[r],l=!1,u=Gt(n);try{for(u.s();!(s=u.n()).done;){var d=s.value;if(d.annCanBeAdd(c)){d.addAnn(c),l=!0;break}}}catch(e){u.e(e)}finally{u.f()}if(!l){var h=new an(e);n.push(h),h.addAnn(c),n.length>20&&o.ZP.warn({content:"Too many tracks may course the page slow.",duration:5})}}a.tracks=n,a.annsHash=(0,f.OT)(a.tracksHashSource(!0)),a.trackedAnnHash=(0,f.OT)(a.tracksHashSource(!1)),a.originAnnHash=a.annsHash},this.buildAnnsForBar=function(){var e=a.env.processbarLength,t=a.env.videoDuration;if(!e||e<=0||!t||t<=0)return[];return a.tracks.map((function(n){return nn(Object.values(n.data).sort((function(e,t){return e.sortStart-t.sortStart})),t,e)}))},this.buildCutsForBar=function(){var e=a.env.processbarLength,t=a.env.videoDuration;if(!e||e<=0||!t||t<=0)return[];var n=Object.values(a.cuts);return(a.respSortedCuts.length<=0||a.respSortedCuts.length!=n.length)&&(a.respSortedCuts=n.sort((function(e,t){return e.sortStart-t.sortStart}))),nn(a.respSortedCuts,t,e)},this.getSelectedPropertyReset=function(e){if(e&&"string"==typeof e&&e.length>0){var t=a.annotations[e];if(t)return t.reset(a.env.videoDuration)}},this.getSelectedCanReset=function(e){if(e&&"string"==typeof e&&e.length>0){var t=a.annotations[e];if(t)return t.canReset()}return!1},this.getSelectedPropertyForm=function(e){if(e&&"string"==typeof e&&e.length>0){var t=a.cuts[e];if(t||(t=a.annotations[e]),t)return t.code4Property(a.env.videoDuration)}return(0,P.jsx)(r.Z.Paragraph,{style:{color:"#979797",textAlign:"center",margin:"0 30px"},children:"Detail settings for an edit you add will appear here."})},this.calcTimeDistance=function(){var e=a.env.processbarLength,t=a.env.videoDuration;if(!e||e<=0||!t||t<=0)return 1;var n=s.ZP.round(s.ZP.divide(e,10*t),1);return n<1&&(n=1),n},this.focusToAction=function(e){if(!e||e.length<=0)return null;var t=a.annotations[e];t&&t.focus()},this.isAnnotationBlur=function(e){if(!e||e.length<=0)return null;var t=a.annotations[e];return!!t&&"blur"==t.type},this.isAnnotationChanged=function(){var e=Object.values(a.annotations).filter((function(e){return"blur"!=e.type})).map((function(e){return e.info}));if(""==a.originAnnHash&&e.length<=0)return!1;var t=(0,f.OT)(e);return a.originAnnHash!=t},this.getSelectedAnnotation=function(e){return!e||e.length<=0?null:a.annotations[e]},this.getSelectedCut=function(e){return!e||e.length<=0?null:a.cuts[e]},this.readonly=t,this.callbacks=n||{},this.reset()}))}}]);